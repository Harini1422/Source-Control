[ {
  "tasks" : [ {
    "uniqueId" : null,
    "directoryUniqueId" : null,
    "source" : null,
    "tags" : [ ],
    "userName" : null,
    "objectType" : "TaskDetails",
    "description" : null,
    "historyReferences" : [ ],
    "usedHistory" : null,
    "sampleInput" : null,
    "sampleOutput" : null,
    "contentTab" : null,
    "successiveTasks" : {
      "incoming" : [ {
        "taskId" : "Certificaterevokation_1",
        "taskName" : null,
        "subflowId" : "DVWpo1UZ",
        "parentSubflowId" : "",
        "taskType" : "start",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ]
    },
    "flowPathID" : null,
    "ignoredForStatusComputation" : true,
    "flowName" : null,
    "subFlowID" : null,
    "globalData" : null,
    "input" : [ ],
    "notificationMessage" : null,
    "ancestor" : null,
    "metaData" : {
      "taskHeader" : "stop",
      "hide" : false,
      "lock" : false,
      "successState" : 1,
      "failoverState" : 2,
      "taskScope" : null,
      "hideFromStageView" : false,
      "mode" : "Developer",
      "nature" : null,
      "lowCodeTask" : false
    },
    "parentSubFlowID" : null,
    "helpContent" : null,
    "rules" : { },
    "cleanUpFlowDetails" : { },
    "subFlowDetails" : [ ],
    "associatedRollbackWorkOrderDetail" : null,
    "_id" : null,
    "task_id" : "workflow_stop_1",
    "task_name" : "Stop",
    "task_type" : "stop",
    "task_category" : "stop",
    "component_type" : "others",
    "setNullProperties" : true,
    "folderName" : null,
    "sub_group" : null,
    "group_name" : null,
    "viewable_type" : "custom"
  }, {
    "uniqueId" : null,
    "directoryUniqueId" : null,
    "source" : null,
    "tags" : [ ],
    "userName" : null,
    "objectType" : "TaskDetails",
    "description" : null,
    "historyReferences" : [ ],
    "usedHistory" : null,
    "sampleInput" : null,
    "sampleOutput" : null,
    "contentTab" : null,
    "successiveTasks" : {
      "incoming" : [ {
        "taskId" : "workflow_start_1",
        "taskName" : null,
        "subflowId" : "DVWpo1UZ",
        "parentSubflowId" : "",
        "taskType" : "start",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ],
      "success" : [ {
        "taskId" : "workflow_stop_1",
        "taskName" : null,
        "subflowId" : "DVWpo1UZ",
        "parentSubflowId" : "",
        "taskType" : "stop",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ]
    },
    "flowPathID" : null,
    "ignoredForStatusComputation" : false,
    "flowName" : "Certificate revokation",
    "subFlowID" : "smwBixBv",
    "globalData" : null,
    "input" : [ ],
    "notificationMessage" : null,
    "ancestor" : null,
    "metaData" : null,
    "parentSubFlowID" : "DVWpo1UZ",
    "helpContent" : null,
    "workflowDetail" : null,
    "workflowTaskComponentDetail" : null,
    "_id" : null,
    "task_id" : "Certificaterevokation_1",
    "task_name" : "Certificate revokation",
    "task_type" : "flow",
    "task_category" : null,
    "component_type" : "others",
    "setNullProperties" : true,
    "folderName" : null,
    "sub_group" : null,
    "group_name" : null,
    "viewable_type" : "custom"
  } ],
  "subFlowID" : "DVWpo1UZ",
  "taskGlobalData" : {
    "workflow_stop_1" : [ ],
    "Certificaterevokation_1" : [ ]
  },
  "type" : null,
  "level" : 0,
  "maxDepth" : 1,
  "input" : null,
  "workflowName" : "Certificate Revoke OOB",
  "description" : null,
  "flowName" : null,
  "workflowType" : "Default",
  "subFlowType" : "Default",
  "parentSubFlowID" : null,
  "logs" : [ ],
  "workflowVersion" : "master"
}, {
  "tasks" : [ {
    "uniqueId" : null,
    "directoryUniqueId" : null,
    "source" : null,
    "tags" : [ ],
    "userName" : null,
    "objectType" : "TaskDetails",
    "description" : null,
    "historyReferences" : [ ],
    "usedHistory" : null,
    "sampleInput" : null,
    "sampleOutput" : null,
    "contentTab" : null,
    "successiveTasks" : { },
    "flowPathID" : null,
    "ignoredForStatusComputation" : true,
    "flowName" : null,
    "subFlowID" : null,
    "globalData" : null,
    "input" : [ ],
    "notificationMessage" : null,
    "ancestor" : null,
    "metaData" : {
      "taskHeader" : "stop",
      "hide" : false,
      "lock" : false,
      "successState" : 1,
      "failoverState" : 2,
      "taskScope" : null,
      "hideFromStageView" : false,
      "mode" : "Developer",
      "nature" : null,
      "lowCodeTask" : false
    },
    "parentSubFlowID" : null,
    "helpContent" : null,
    "rules" : { },
    "cleanUpFlowDetails" : { },
    "subFlowDetails" : [ ],
    "associatedRollbackWorkOrderDetail" : null,
    "_id" : null,
    "task_id" : "workflow_stop_1",
    "task_name" : "Stop",
    "task_type" : "stop",
    "task_category" : "stop",
    "component_type" : "others",
    "setNullProperties" : true,
    "folderName" : null,
    "sub_group" : null,
    "group_name" : null,
    "viewable_type" : "custom"
  } ],
  "subFlowID" : "JD4ZHRpr",
  "taskGlobalData" : {
    "workflow_stop_1" : [ ]
  },
  "type" : null,
  "level" : 0,
  "maxDepth" : 0,
  "input" : null,
  "workflowName" : "Certificate Revoke OOB",
  "description" : null,
  "flowName" : null,
  "workflowType" : "Rollback",
  "subFlowType" : "Default",
  "parentSubFlowID" : null,
  "logs" : [ ],
  "workflowVersion" : "master"
}, {
  "tasks" : [ {
    "uniqueId" : null,
    "directoryUniqueId" : null,
    "source" : null,
    "tags" : [ ],
    "userName" : null,
    "objectType" : "TaskDetails",
    "description" : null,
    "historyReferences" : [ ],
    "usedHistory" : null,
    "sampleInput" : null,
    "sampleOutput" : null,
    "contentTab" : null,
    "successiveTasks" : {
      "incoming" : [ {
        "taskId" : "script_1",
        "taskName" : null,
        "subflowId" : "Ym3Jra2C",
        "parentSubflowId" : "DVWpo1UZ",
        "taskType" : "start",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ]
    },
    "flowPathID" : null,
    "ignoredForStatusComputation" : true,
    "flowName" : null,
    "subFlowID" : null,
    "globalData" : null,
    "input" : [ ],
    "notificationMessage" : null,
    "ancestor" : null,
    "metaData" : {
      "taskHeader" : "stop",
      "hide" : false,
      "lock" : false,
      "successState" : 1,
      "failoverState" : 2,
      "taskScope" : null,
      "hideFromStageView" : false,
      "mode" : "Developer",
      "nature" : null,
      "lowCodeTask" : false
    },
    "parentSubFlowID" : null,
    "helpContent" : null,
    "rules" : { },
    "cleanUpFlowDetails" : { },
    "subFlowDetails" : [ ],
    "associatedRollbackWorkOrderDetail" : null,
    "_id" : null,
    "task_id" : "workflow_stop_1",
    "task_name" : "Stop flow",
    "task_type" : "stop",
    "task_category" : "stop",
    "component_type" : "others",
    "setNullProperties" : true,
    "folderName" : null,
    "sub_group" : null,
    "group_name" : null,
    "viewable_type" : "custom"
  }, {
    "uniqueId" : null,
    "directoryUniqueId" : null,
    "source" : null,
    "tags" : [ ],
    "userName" : null,
    "objectType" : "TaskDetails",
    "description" : "",
    "historyReferences" : [ ],
    "usedHistory" : null,
    "sampleInput" : null,
    "sampleOutput" : null,
    "contentTab" : null,
    "successiveTasks" : {
      "incoming" : [ {
        "taskId" : "workflow_start_1",
        "taskName" : null,
        "subflowId" : "Ym3Jra2C",
        "parentSubflowId" : "DVWpo1UZ",
        "taskType" : "start",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ],
      "success" : [ {
        "taskId" : "script_1",
        "taskName" : null,
        "subflowId" : "Ym3Jra2C",
        "parentSubflowId" : "DVWpo1UZ",
        "taskType" : "script",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ]
    },
    "flowPathID" : null,
    "ignoredForStatusComputation" : false,
    "flowName" : null,
    "subFlowID" : null,
    "globalData" : null,
    "input" : [ ],
    "notificationMessage" : {
      "401" : ""
    },
    "ancestor" : null,
    "metaData" : {
      "taskHeader" : "Form",
      "hide" : false,
      "lock" : false,
      "successState" : 1,
      "failoverState" : 2,
      "taskScope" : null,
      "hideFromStageView" : false,
      "mode" : "Developer",
      "nature" : "normal",
      "lowCodeTask" : false
    },
    "parentSubFlowID" : null,
    "helpContent" : null,
    "dynamicAuth" : null,
    "regexList" : null,
    "regexOperation" : null,
    "regexPattern" : null,
    "accessMode" : null,
    "proceedProcess" : "Submit",
    "breakdownProcess" : "Back",
    "cancelProcess" : "Cancel",
    "saveDraftProcess" : "Save Draft",
    "closeProcess" : "Exit",
    "enableSaveDraft" : false,
    "enableCancel" : true,
    "enableClose" : false,
    "enableAutoApprove" : null,
    "enableBreakDown" : false,
    "availableGlobalData" : null,
    "_id" : null,
    "task_id" : "createform_1",
    "task_name" : "Select Common name or CA",
    "task_type" : "form",
    "task_category" : "form",
    "component_type" : "form",
    "setNullProperties" : true,
    "folderName" : "Cert+ OOB",
    "sub_group" : "form",
    "group_name" : "User interface",
    "viewable_type" : "default",
    "aclIdentifiers" : null,
    "template" : {
      "name" : "Select Common name or CA",
      "description" : null,
      "aclIdentifiers" : null,
      "fields" : [ {
        "labelName" : "Select revokation mode",
        "elementType" : "Radio button",
        "values" : "Certificate authority,Common name",
        "fieldId" : "revokation_mode",
        "fieldScript" : "Fetch group",
        "aclFilter" : "None",
        "dependsOn" : "",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : true,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Certificate group",
        "elementType" : "Dropdown",
        "values" : "",
        "fieldId" : "cert_group",
        "fieldScript" : "",
        "aclFilter" : "None",
        "dependsOn" : "revokation_mode:Certificate authority",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Certificate authority",
        "elementType" : "Dropdown",
        "values" : "",
        "fieldId" : "cert_authority",
        "fieldScript" : "Get certificate authority",
        "aclFilter" : "None",
        "dependsOn" : "revokation_mode:Certificate authority",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Common name",
        "elementType" : "Text box",
        "values" : "",
        "fieldId" : "common_name",
        "fieldScript" : "Fetch certificates",
        "aclFilter" : "None",
        "dependsOn" : "revokation_mode:Common name",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : false,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Certificate name",
        "elementType" : "Multi select",
        "values" : "",
        "fieldId" : "cert_name",
        "fieldScript" : "",
        "aclFilter" : "None",
        "dependsOn" : "revokation_mode:Common name",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Certificate name",
        "elementType" : "Multi select",
        "values" : "",
        "fieldId" : "cert_name_basedon_ca",
        "fieldScript" : "Get certs based on CA",
        "aclFilter" : "None",
        "dependsOn" : "revokation_mode:Certificate authority",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Reason",
        "elementType" : "Text box",
        "values" : "",
        "fieldId" : "reason",
        "fieldScript" : "",
        "aclFilter" : "None",
        "dependsOn" : "cert_authority:DigiCert|cert_authority:Comodo Certificate Manager",
        "dataValidation" : "",
        "parent" : "",
        "help" : "This reason will applicable for all the certificates",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Reason",
        "elementType" : "Dropdown",
        "values" : "Key compromise,CA compromise,Affiliation changed,Superseded,Cessation of operation",
        "fieldId" : "reason_microsoft",
        "fieldScript" : "",
        "aclFilter" : "None",
        "dependsOn" : "cert_authority:Microsoft Enterprise",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      } ],
      "fieldScripts" : [ {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ ],
        "responseMapping" : null,
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Cancel request",
        "scriptData" : "",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ ],
        "responseMapping" : null,
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Discard request",
        "scriptData" : "",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ ],
        "responseMapping" : null,
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Submit request",
        "scriptData" : "",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ "common_name" ],
        "responseMapping" : {
          "response" : {
            "" : ""
          }
        },
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Fetch certificates",
        "scriptData" : "aW1wb3J0IHN5cwppbXBvcnQganNvbgppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IG9zCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCmZyb20gZGF0ZXRpbWUgaW1wb3J0IHRpbWVkZWx0YQpmcm9tIGNvbmZpZ29iaiBpbXBvcnQgQ29uZmlnT2JqCgp0cnVlID0gVHJ1ZQpmYWxzZSA9IEZhbHNlCm51bGwgPSBOb25lCgpzZWxlY3RfY2VydF91c2luZyA9ICc8c2VsZWN0X2NlcnRfdXNpbmc+JwpzZWxlY3RfY2EgPSAnPGNlcnRfYXV0aG9yaXR5PicKY2VydF9ncm91cCA9ICc8YXNzaWduX2dyb3VwPicKCnN5cy5wYXRoLmluc2VydCgwLEFWWDo6SEVMUEVSKQpzeXMucGF0aC5pbnNlcnQoMCxBVlg6OkRFUEVOREVOQ0lFUykKCmltcG9ydCBsb2dnZXJfdXRpbApsb2dnZXIgPSBsb2dnZXJfdXRpbC5nZXRfbG9nZ2VyKCJDZXJ0IFJlbmV3IE9PQiIpCgpkZWYgZmV0Y2hfZ2F0ZXdheV9rZXkoKToKICAgIGNvbmZfY29udGVudCA9IHt9CiAgICBhYnNfcGF0aCA9IG9zLnBhdGguZGlybmFtZShvcy5wYXRoLmFic3BhdGgoX19maWxlX18pKQogICAgcHJvcF9maWxlX3BhdGggPSBhYnNfcGF0aCArICIvLi4vcHJvcGVydGllcy9hcHB2aWV3eC5wcm9wZXJ0aWVzIgogICAgY29uZmlnID0gQ29uZmlnT2JqKHByb3BfZmlsZV9wYXRoKQogICAgcmV0dXJuIGNvbmZpZ1snR0FURVdBWV9CQVNFX1VSTCddLCBjb25maWdbJ0dBVEVXQVlfS0VZJ10KCgpkZWYgZ2V0X2NlcnRzX2Jhc2VkX29uX2NuKCk6CiAgICBjYXRlZ29yeV90eXBlcyA9IFsiU2VydmVyIiwgIkNsaWVudCIsICJEZXZpY2UiLCAiQ29kZSBTaWduaW5nIl0KICAgIGNlcnRfbGlzdCA9IFtdCiAgICBmb3IgY2F0ZWdvcnkgaW4gY2F0ZWdvcnlfdHlwZXM6CiAgICAgICAgb2J0YWluZWRSZWNvcmRzID0gMTAwCiAgICAgICAgc3RhcnQgPSAxCiAgICAgICAgd2hpbGUgb2J0YWluZWRSZWNvcmRzID09IDEwMDoKICAgICAgICAgICAgY29tbW9uX25hbWVfbGlzdCwgb2J0YWluZWRSZWNvcmRzID0gZ2V0X2NlcnRzKGNhdGVnb3J5LHN0YXJ0KQogICAgICAgICAgICBjZXJ0X2xpc3QuZXh0ZW5kKGNvbW1vbl9uYW1lX2xpc3QpCiAgICAgICAgICAgIHN0YXJ0ICs9IDEwMAogICAgcmV0dXJuIGNlcnRfbGlzdAoKCmRlZiBnZXRfY2VydHMoY2F0ZWdvcnksIHN0YXJ0KToKICAgIGNvbW1vbl9uYW1lID0gJzxjb21tb25fbmFtZT4nCiAgICBjb21tb25fbmFtZV9saXN0ID0gW10KICAgIGdhdGV3YXlfdXJsLCBnYXRld2F5X2tleSA9IGZldGNoX2dhdGV3YXlfa2V5KCkKICAgIHVybCA9ICJ7fWF2eGFwaS9jZXJ0aWZpY2F0ZS9zZWFyY2g/Z3drZXk9e30mZ3dzb3VyY2U9ZXh0ZXJuYWwiLmZvcm1hdCgKICAgICAgICBnYXRld2F5X3VybCwgZ2F0ZXdheV9rZXkpCiAgICBoZWFkZXJzID0gewogICAgICAgICJzZXNzaW9uSWQiOiAnPCVzZXNzaW9uSWQlPicsCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iCiAgICB9CiAgICBwYXlsb2FkID0gewogICAgICAgICJpbnB1dCI6IHsKICAgICAgICAgICAgImNvbW1vbk5hbWUiOiBjb21tb25fbmFtZSwKICAgICAgICAgICAgImNhdGVnb3J5IjogY2F0ZWdvcnkKICAgICAgICB9LAogICAgICAgICJmaWx0ZXIiOiB7CiAgICAgICAgICAgICJzdGFydCI6IHN0YXJ0LAogICAgICAgICAgICAiY29tbW9uTmFtZSI6IGNvbW1vbl9uYW1lCiAgICAgICAgfQogICAgfQogICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KAogICAgICAgIHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKHBheWxvYWQpLCB2ZXJpZnk9RmFsc2UpCiAgICBsb2dnZXIuaW5mbyhzdHIocmVzcG9uc2UuanNvbigpKSkKICAgIGNlcnRzID0gcmVzcG9uc2UuanNvbigpLmdldCgicmVzcG9uc2UiKS5nZXQoInJlc3BvbnNlIikuZ2V0KCJvYmplY3RzIikKICAgIG9idGFpbmVkX3JlY29yZHMgPSByZXNwb25zZS5qc29uKCkuZ2V0KCJyZXNwb25zZSIpLmdldCgicmVzcG9uc2UiKS5nZXQoCiAgICAgICAgIm9idGFpbmVkUmVjb3JkcyIpCiAgICBmb3IgY2VydCBpbiBjZXJ0czoKICAgICMgICBpZiBjZXJ0Wydncm91cCddID09IGNlcnRfZ3JvdXAgYW5kIGNlcnRbJ2NlcnRpZmljYXRlQXV0aG9yaXR5J10gPT0gc2VsZWN0X2NhIGFuZCBjZXJ0Wydwcml2YXRla2V5QXZhbGlhYmxlJ10gPT0gVHJ1ZToKICAgICAgICBjbiA9IGNlcnRbJ2NvbW1vbk5hbWUnXSArICd8JyArIGNlcnRbJ3NlcmlhbE51bWJlciddCiAgICAgICAgY29tbW9uX25hbWVfbGlzdC5hcHBlbmQoY24pCiAgICByZXR1cm4gY29tbW9uX25hbWVfbGlzdCwgb2J0YWluZWRfcmVjb3JkcwoKZGVmIGdldF9hbGxfY2VydHMoY2F0ZWdvcnksIHN0YXJ0KToKICAgIGNvbW1vbl9uYW1lID0gJzxjb21tb25fbmFtZT4nCiAgICBjb21tb25fbmFtZV9saXN0ID0gW10KICAgIGdhdGV3YXlfdXJsLCBnYXRld2F5X2tleSA9IGZldGNoX2dhdGV3YXlfa2V5KCkKICAgIHVybCA9ICJ7fWF2eGFwaS9jZXJ0LWNlcnRpZmljYXRlLWludmVudG9yeS1saXN0P2d3a2V5PXt9Jmd3c291cmNlPWV4dGVybmFsIi5mb3JtYXQoCiAgICAgICAgZ2F0ZXdheV91cmwsIGdhdGV3YXlfa2V5KQogICAgaGVhZGVycyA9IHsKICAgICAgICAic2Vzc2lvbklkIjogJzwlc2Vzc2lvbklkJT4nLAogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIgogICAgfQogICAgcGF5bG9hZCA9IHsKICAgICAgICAicGF5bG9hZCI6IHsKICAgICAgICAgICAgInNraXAiOiBzdGFydCwKICAgICAgICAgICAgImxpbWl0IjogMTAwLAogICAgICAgICAgICAic29ydCI6IHsiX2lkIjogLTF9LAogICAgICAgICAgICAic3RhcnQiOiBzdGFydCwKICAgICAgICAgICAgImNhdGVnb3JpZXMiOiBjYXRlZ29yeQogICAgICAgIH0KICAgIH0KICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCgKICAgICAgICB1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9anNvbi5kdW1wcyhwYXlsb2FkKSwgdmVyaWZ5PUZhbHNlKQogICAgY2VydHMgPSByZXNwb25zZS5qc29uKCkuZ2V0KCJyZXNwb25zZSIpLmdldCgiZGF0YSIpCiAgICBvYnRhaW5lZF9yZWNvcmRzID0gbGVuKHJlc3BvbnNlLmpzb24oKS5nZXQoInJlc3BvbnNlIikuZ2V0KCJkYXRhIikpCiAgICAKICAgIGZvciBjZXJ0IGluIGNlcnRzOgogICAgICAgIGlmIGNlcnRbJ2dyb3VwJ10gPT0gY2VydF9ncm91cCBhbmQgY2VydFsnY2VydGlmaWNhdGVBdXRob3JpdHknXSA9PSBzZWxlY3RfY2EgYW5kIGNlcnRbJ3ByaXZhdGVrZXlBdmFsaWFibGUnXSA9PSBUcnVlOgogICAgICAgICAgICBjbiA9IGNlcnRbJ2NvbW1vbk5hbWUnXSArICd8JyArIGNlcnRbJ3NlcmlhbE51bWJlciddCiAgICAgICAgICAgIGNvbW1vbl9uYW1lX2xpc3QuYXBwZW5kKGNuKQogICAgcmV0dXJuIGNvbW1vbl9uYW1lX2xpc3QsIG9idGFpbmVkX3JlY29yZHMKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICAjIG9wZXJhdGlvbl90eXBlID0gJycKICAgICMgb3Bfd2l0aG91dF9yZWlzc3VlID0gJzxvcF90eXBlX3JlaXNzdWU+JwogICAgIyBvcF93aXRoX3JlaXNzdWUgPSAnPG9wX3R5cGU+JwogICAgIyBjYXRlZ29yeSA9IFsic2VydmVyIiwgImRldmljZSIsICJjbGllbnQiLCAiY29kZVNpZ25pbmciXQogICAgCiAgICBjZXJ0aWZpY2F0ZXMgPSBbXQogICAgCiAgICBjZXJ0aWZpY2F0ZXMuZXh0ZW5kKGdldF9jZXJ0c19iYXNlZF9vbl9jbigpKQoKICAgIGlmIGxlbihjZXJ0aWZpY2F0ZXMpID09IDA6CiAgICAgICAgcHJpbnQoanNvbi5kdW1wcyh7ImVycm9yIjoiTm8gY2VydGlmaWNhdGVzIGZvdW5kIn0pKQogICAgZWxzZToKICAgICAgICBkYXRhID0gW3siY2VydF9uYW1lIjogdmFsfSBmb3IgdmFsIGluIGNlcnRpZmljYXRlc10KICAgICAgICBwcmludChqc29uLmR1bXBzKGRhdGEpKQ==",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ "revokation_mode" ],
        "responseMapping" : {
          "response" : {
            "" : ""
          }
        },
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Fetch group",
        "scriptData" : "aW1wb3J0IHN5cwppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHJlCmltcG9ydCBqc29uCnN5cy5wYXRoLmluc2VydCgwLEFWWDo6SEVMUEVSKQpzeXMucGF0aC5pbnNlcnQoMCxBVlg6OkRFUEVOREVOQ0lFUykKaW1wb3J0IGFwcHZpZXd4CmltcG9ydCBsb2dnZXJfdXRpbAoKCmxvZ2dlciA9IGxvZ2dlcl91dGlsLmdldF9sb2dnZXIoJ0dldCBDZXJ0aWZpY2F0ZSBncm91cCcpCgpkZWYgZ2V0Q2VydGlmaWNhdGVHcm91cCgpOgogICAgIiIiCiAgICBGdW5jdGlvbiB0byBGZXRjaCB0aGUgY29uZmlndXJlZCBjZXJ0aWZpY2F0ZSBncm91cAogICAgCiAgICA6cmV0dXJuOiBDZXJ0aWZpY2F0ZSBwb2xpY3kKICAgICIiIgogICAga2V5ID0gc3RyKCkKICAgIGdhdGV3YXlfdXJsLCBnYXRld2F5X2tleSA9IGZldGNoX2dhdGV3YXlfa2V5KCkKICAgIGN3ZCA9IG9zLmdldGN3ZCgpCiAgICB1cmwgPSAie31hdnhhcGkvY2VydC1ncm91cC1zZWFyY2g/Z3drZXk9e30mZ3dzb3VyY2U9ZXh0ZXJuYWwiLmZvcm1hdChnYXRld2F5X3VybCwgZ2F0ZXdheV9rZXkpCiAgICBoZWFkZXJzID0geyJzZXNzaW9uSWQiOiAiPCVzZXNzaW9uSWQlPiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiJ9CgogICAgIyBwYXlsb2FkID0geyJwYXlsb2FkIjp7ImxvZyI6IFRydWUsInBhc3N3b3JkIjogYmFzZTY0LmI2NGVuY29kZShmaWxlX3Bhc3N3b3JkLmVuY29kZSgpKS5kZWNvZGUoKSwidXVJZCI6IGNlcnRfaWR9fQoKICAgIHBheWxvYWQgPSB7InBheWxvYWQiOnsgInN0YXJ0SW5kZXgiOjAsImRpc3BsYXlMZW5ndGgiOjEwMCwic2VhcmNoVGV4dCI6IiIsInNvcnRPcmRlciI6ImFzYyIsInNvcnRDb2x1bW4iOiJuYW1lIn19CiAgICAKICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9anNvbi5kdW1wcyhwYXlsb2FkKSwgdmVyaWZ5PUZhbHNlKQogICAgIyBsb2dnZXIuaW5mbygiPT09PT09PT09Q2VydGlmaWNhdGVTZWFyY2g9PT09PT09PT09IikKICAgICMgQVZYOjpMT0coIj09PT09PT09PUNlcnRpZmljYXRlU2VhcmNoPT09PT09PT09PSIpCiAgICAjIGxvZ2dlci5pbmZvKHJlc3BvbnNlLnRleHQpCiAgICAjIGxvZ2dlci5pbmZvKHJlc3BvbnNlLnJlYXNvbikKICAgIHJlc3BvbnNlID0gcmVzcG9uc2UuanNvbigpCiAgICBsb2dnZXIuaW5mbygnLS0tPicrc3RyKHJlc3BvbnNlKSkKICAgICMgcmV0dXJuIHR5cGUocmVzcG9uc2UpLCB0eXBlKHJlc3BvbnNlWydyZXNwb25zZSddKQogICAgcmVzcG9uc2UgPSByZXNwb25zZS5nZXQoInJlc3BvbnNlIikuZ2V0KCJkYXRhIikKICAgIAogICAgZ3JvdXBzID0gW10KICAgIGZvciBjZXJ0X2dyb3VwIGluIHJlc3BvbnNlOgogICAgICAgIGdyb3Vwcy5hcHBlbmQoY2VydF9ncm91cC5nZXQoIm5hbWUiKSkKICAgIAogICAgcmV0dXJuIGdyb3VwcwoKZGVmIGZldGNoX2dhdGV3YXlfa2V5KCk6CiAgICAnJycKICAgIGZldGNoIHRoZSBnYXRld2F5IGtleSBmcm9tIGFwcHZpZXd4IGNvbmZpZyBmaWxlCiAgICA6cmV0dXJuOiBhcHB2aWV3eCBnYXRld2F5IGtleQogICAgJycnCiAgICBjb25mX2NvbnRlbnQgPSB7fQogICAgYWJzX3BhdGggPSBvcy5wYXRoLmRpcm5hbWUob3MucGF0aC5hYnNwYXRoKF9fZmlsZV9fKSkKICAgICMgbG9nZ2VyLmluZm8oJ1BBVEgnKQogICAgIyBsb2dnZXIuaW5mbyhhYnNfcGF0aCkKICAgIHByb3BfZmlsZV9wYXRoID0gYWJzX3BhdGggKyAiLy4uL3Byb3BlcnRpZXMvYXBwdmlld3gucHJvcGVydGllcyIKICAgIHByb3BfZmlsZSA9IG9wZW4ocHJvcF9maWxlX3BhdGgpCiAgICBwcm9wX2ZpbGVfbGluZXMgPSBwcm9wX2ZpbGUucmVhZGxpbmVzKCkKICAgIGZvciBsaW5lIGluIHByb3BfZmlsZV9saW5lczoKICAgICAgICBpZiBsaW5lIGlzIG5vdCAiXG4iIGFuZCAiR0FURVdBWV9LRVkiIGluIGxpbmUgb3IgIkdBVEVXQVlfQkFTRV9VUkwiIGluIGxpbmU6CiAgICAgICAgICAgIGNvbmZfY29udGVudFtsaW5lLnNwbGl0KCI9IilbMF1dID0gbGluZS5zcGxpdCgiPSIpWzFdLnJlcGxhY2UoIlxuIiwgIiIpCiAgICByZXR1cm4gY29uZl9jb250ZW50WydHQVRFV0FZX0JBU0VfVVJMJ10sIGNvbmZfY29udGVudFsnR0FURVdBWV9LRVknXQogICAgcHJvcF9maWxlLmNsb3NlKCkKCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKCiAgICBjZXJ0aWZpY2F0ZV9ncm91cCA9IGdldENlcnRpZmljYXRlR3JvdXAoKQogICAgCiAgICAjIGRhdGEgPSAgW3siY2VydGlmaWNhdGVfYXR0cmlidXRlIjp2YWx9IGZvciB2YWwgaW4gY2VydF9hdHRyaWJdICsgW3siY2VydGlmaWNhdGVfYXV0aG9yaXR5Ijp2YWx9IGZvciB2YWwgaW4gY2VydGlmaWNhdGVfYXV0aG9yaXR5XQogICAgZGF0YSA9ICBbeyJjZXJ0X2dyb3VwIjp2YWx9IGZvciB2YWwgaW4gY2VydGlmaWNhdGVfZ3JvdXBdCiAgICAjIGRhdGEgPSBbeyJjZXJ0X2V4cGlyeV9mb3JtX2ZpZWxkcyI6dmFsfSBmb3IgdmFsIGluIGNlcnRfZXhwX2Zvcm1fZmllbGRzXQogICAgaWYgZGF0YToKICAgICAgICBwcmludChqc29uLmR1bXBzKGRhdGEpKQogICAgZWxzZToKICAgICAgICBwcmludChqc29uLmR1bXBzKHsnZXJyb3InOiAnTm8gQ2VydGlmaWNhdGUgR3JvdXAgaGFzIGJlZW4gY29uZmlndXJlZCd9KSkKCg==",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ "cert_authority" ],
        "responseMapping" : {
          "response" : {
            "" : ""
          }
        },
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Get certificate authority",
        "scriptData" : "aW1wb3J0IHN5cwppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHJlCmltcG9ydCBqc29uCnN5cy5wYXRoLmluc2VydCgwLEFWWDo6SEVMUEVSKQpzeXMucGF0aC5pbnNlcnQoMCxBVlg6OkRFUEVOREVOQ0lFUykKaW1wb3J0IGFwcHZpZXd4CmltcG9ydCBsb2dnZXJfdXRpbAoKCmxvZ2dlciA9IGxvZ2dlcl91dGlsLmdldF9sb2dnZXIoJ0dldCBDZXJ0aWZpY2F0ZSBwb2xpY3knKQoKZGVmIGdldENlcnRpZmljYXRlUG9saWN5KCk6CiAgICAiIiIKICAgIEZ1bmN0aW9uIHRvIEZldGNoIHRoZSBjb25maWd1cmVkIGNlcnRpZmljYXRlIGdyb3VwCiAgICAKICAgIDpyZXR1cm46IENlcnRpZmljYXRlIHBvbGljeQogICAgIiIiCiAgICBrZXkgPSBzdHIoKQogICAgZ2F0ZXdheV91cmwsIGdhdGV3YXlfa2V5ID0gZmV0Y2hfZ2F0ZXdheV9rZXkoKQogICAgY3dkID0gb3MuZ2V0Y3dkKCkKICAgIGNhdCA9ICJzZXJ2ZXIiCiAgICAKICAgIGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJTZXJ2ZXIiOgogICAgICAgIGNhdCA9ICJzZXJ2ZXIiCiAgICBlbGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJDbGllbnQiOgogICAgICAgIGNhdCA9ICJjbGllbnQiCiAgICBlbGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJDb2RlU2lnbmluZyI6CiAgICAgICAgY2F0ID0gImNvZGVTaWduaW5nIgogICAgICAgIAogICAgdXJsID0gInt9YXZ4YXBpL2NlcnQtZ2V0LXBvbGljeS1ieS1ncm91cG5hbWU/Y2VydGlmaWNhdGVHcm91cE5hbWU9e30mY2VydGlmaWNhdGVDYXRlZ29yeT17fT9nd2tleT17fSZnd3NvdXJjZT1leHRlcm5hbCIuZm9ybWF0KGdhdGV3YXlfdXJsLCc8Y2VydF9ncm91cD4nLGNhdCAsIGdhdGV3YXlfa2V5KQogICAgaGVhZGVycyA9IHsic2Vzc2lvbklkIjogIjwlc2Vzc2lvbklkJT4iLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24ifQoKICAgICMgcGF5bG9hZCA9IHsicGF5bG9hZCI6eyJsb2ciOiBUcnVlLCJwYXNzd29yZCI6IGJhc2U2NC5iNjRlbmNvZGUoZmlsZV9wYXNzd29yZC5lbmNvZGUoKSkuZGVjb2RlKCksInV1SWQiOiBjZXJ0X2lkfX0KICAgIAogICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsPXVybCwgaGVhZGVycz1oZWFkZXJzLCB2ZXJpZnk9RmFsc2UpCiAgICAjIGxvZ2dlci5pbmZvKCI9PT09PT09PT1DZXJ0aWZpY2F0ZVNlYXJjaD09PT09PT09PT0iKQogICAgIyBBVlg6OkxPRygiPT09PT09PT09Q2VydGlmaWNhdGVTZWFyY2g9PT09PT09PT09IikKICAgICMgbG9nZ2VyLmluZm8ocmVzcG9uc2UudGV4dCkKICAgICMgbG9nZ2VyLmluZm8ocmVzcG9uc2UucmVhc29uKQogICAgcmVzcG9uc2UgPSByZXNwb25zZS5qc29uKCkKICAgIGxvZ2dlci5pbmZvKCctLS0+JytzdHIocmVzcG9uc2UpKQogICAgCiAgICByZXR1cm4gcmVzcG9uc2UuZ2V0KCJyZXNwb25zZSIpLmdldCgidHlwZSIpCgpkZWYgZmV0Y2hfZ2F0ZXdheV9rZXkoKToKICAgICcnJwogICAgZmV0Y2ggdGhlIGdhdGV3YXkga2V5IGZyb20gYXBwdmlld3ggY29uZmlnIGZpbGUKICAgIDpyZXR1cm46IGFwcHZpZXd4IGdhdGV3YXkga2V5CiAgICAnJycKICAgIGNvbmZfY29udGVudCA9IHt9CiAgICBhYnNfcGF0aCA9IG9zLnBhdGguZGlybmFtZShvcy5wYXRoLmFic3BhdGgoX19maWxlX18pKQogICAgIyBsb2dnZXIuaW5mbygnUEFUSCcpCiAgICAjIGxvZ2dlci5pbmZvKGFic19wYXRoKQogICAgcHJvcF9maWxlX3BhdGggPSBhYnNfcGF0aCArICIvLi4vcHJvcGVydGllcy9hcHB2aWV3eC5wcm9wZXJ0aWVzIgogICAgcHJvcF9maWxlID0gb3Blbihwcm9wX2ZpbGVfcGF0aCkKICAgIHByb3BfZmlsZV9saW5lcyA9IHByb3BfZmlsZS5yZWFkbGluZXMoKQogICAgZm9yIGxpbmUgaW4gcHJvcF9maWxlX2xpbmVzOgogICAgICAgIGlmIGxpbmUgaXMgbm90ICJcbiIgYW5kICJHQVRFV0FZX0tFWSIgaW4gbGluZSBvciAiR0FURVdBWV9CQVNFX1VSTCIgaW4gbGluZToKICAgICAgICAgICAgY29uZl9jb250ZW50W2xpbmUuc3BsaXQoIj0iKVswXV0gPSBsaW5lLnNwbGl0KCI9IilbMV0ucmVwbGFjZSgiXG4iLCAiIikKICAgIHJldHVybiBjb25mX2NvbnRlbnRbJ0dBVEVXQVlfQkFTRV9VUkwnXSwgY29uZl9jb250ZW50WydHQVRFV0FZX0tFWSddCiAgICBwcm9wX2ZpbGUuY2xvc2UoKQoKCgpkZWYgZ2V0Q2VydGlmaWNhdGVBdXRob3JpdHkoKToKICAgICIiIgogICAgRnVuY3Rpb24gdG8gRmV0Y2ggdGhlIGNvbmZpZ3VyZWQgY2VydGlmaWNhdGUgZ3JvdXAKICAgIAogICAgOnJldHVybjogQ2VydGlmaWNhdGUgcG9saWN5CiAgICAiIiIKICAgIGtleSA9IHN0cigpCiAgICBnYXRld2F5X3VybCwgZ2F0ZXdheV9rZXkgPSBmZXRjaF9nYXRld2F5X2tleSgpCiAgICBjd2QgPSBvcy5nZXRjd2QoKQogICAgY2F0ID0gInNlcnZlciIKICAgIGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJTZXJ2ZXIiOgogICAgICAgIGNhdCA9ICJzZXJ2ZXIiCiAgICBlbGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJDbGllbnQiOgogICAgICAgIGNhdCA9ICJjbGllbnQiCiAgICBlbGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJDb2RlU2lnbmluZyI6CiAgICAgICAgY2F0ID0gImNvZGVTaWduaW5nIgogICAgICAgIAogICAgdXJsID0gInt9YXZ4YXBpL2NlcnQtZ2V0LXBvbGljeS1ieS1ncm91cG5hbWU/Y2VydGlmaWNhdGVHcm91cE5hbWU9e30mY2VydGlmaWNhdGVDYXRlZ29yeT17fT9nd2tleT17fSZnd3NvdXJjZT1leHRlcm5hbCIuZm9ybWF0KGdhdGV3YXlfdXJsLCc8Y2VydF9ncm91cD4nLGNhdCAsIGdhdGV3YXlfa2V5KQogICAgaGVhZGVycyA9IHsic2Vzc2lvbklkIjogIjwlc2Vzc2lvbklkJT4iLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24ifQoKICAgICMgcGF5bG9hZCA9IHsicGF5bG9hZCI6eyJsb2ciOiBUcnVlLCJwYXNzd29yZCI6IGJhc2U2NC5iNjRlbmNvZGUoZmlsZV9wYXNzd29yZC5lbmNvZGUoKSkuZGVjb2RlKCksInV1SWQiOiBjZXJ0X2lkfX0KICAgIAogICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsPXVybCwgaGVhZGVycz1oZWFkZXJzLCB2ZXJpZnk9RmFsc2UpCiAgICAjIGxvZ2dlci5pbmZvKCI9PT09PT09PT1DZXJ0aWZpY2F0ZVNlYXJjaD09PT09PT09PT0iKQogICAgIyBBVlg6OkxPRygiPT09PT09PT09Q2VydGlmaWNhdGVTZWFyY2g9PT09PT09PT09IikKICAgICMgbG9nZ2VyLmluZm8ocmVzcG9uc2UudGV4dCkKICAgICMgbG9nZ2VyLmluZm8ocmVzcG9uc2UucmVhc29uKQogICAgcmVzcG9uc2UgPSByZXNwb25zZS5qc29uKCkKICAgIGxvZ2dlci5pbmZvKCdSRVM+Picrc3RyKHJlc3BvbnNlKSkKICAgIAogICAgcmVzcG9uc2UgPSByZXNwb25zZS5nZXQoInJlc3BvbnNlIikuZ2V0KCJjZXJ0aWZpY2F0ZVBvbGljeUNhQWNjb3VudERldGFpbHMiKQogICAgCiAgICBjYSA9IFtdCiAgICAKICAgIGZvciByZXMgaW4gcmVzcG9uc2U6CiAgICAgICAgbG9nZ2VyLmluZm8oIlJFUy0tLTw8PCIrc3RyKHJlcykpCiAgICAgICAgaWYgcmVzWyJjZXJ0aWZpY2F0ZUF1dGhvcml0eSJdOgogICAgICAgICAgICBjYS5hcHBlbmQocmVzLmdldCgiY2VydGlmaWNhdGVBdXRob3JpdHkiKSkKICAgIHJldHVybiBjYQoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CgogICAgY2VydGlmaWNhdGVfcG9saWN5ID0gZ2V0Q2VydGlmaWNhdGVQb2xpY3koKQogICAgY2VydGlmaWNhdGVfYXV0aG9yaXR5ID0gZ2V0Q2VydGlmaWNhdGVBdXRob3JpdHkoKQoKICAgIGlmIGNlcnRpZmljYXRlX3BvbGljeToKICAgICAgICBpZiBjZXJ0aWZpY2F0ZV9hdXRob3JpdHk6CiAgICAgICAgICAgIGRhdGEgPSBbeyJjZXJ0X2F1dGhvcml0eSI6dmFsfSBmb3IgdmFsIGluIGNlcnRpZmljYXRlX2F1dGhvcml0eV0KICAgICAgICAgICAgcHJpbnQoanNvbi5kdW1wcyhkYXRhKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludChqc29uLmR1bXBzKHsnZXJyb3InOiAnTm8gY2VydGlmaWNhdGUgYXV0aG9yaXR5IGlzIGFzc29jaWF0ZWQgd2l0aCB0aGlzIENlcnRpZmljYXRlIEdyb3VwJ30pKQogICAgZWxzZToKICAgICAgICBwcmludChqc29uLmR1bXBzKHsnZXJyb3InOiAnTm8gcG9saWN5IGlzIGFzc29jaWF0ZWQgd2l0aCB0aGlzIENlcnRpZmljYXRlIEdyb3VwJ30pKQo=",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ "cert_name_basedon_ca" ],
        "responseMapping" : {
          "response" : {
            "" : ""
          }
        },
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Get certs based on CA",
        "scriptData" : "aW1wb3J0IHN5cwppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IGpzb24KZnJvbSBkYXRldGltZSBpbXBvcnQgdGltZWRlbHRhCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGUKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKCnN5cy5wYXRoLmFwcGVuZChBVlg6OkRFUEVOREVOQ0lFUykKc3lzLnBhdGguYXBwZW5kKEFWWDo6SEVMUEVSKQoKaW1wb3J0IGFwcHZpZXd4CmltcG9ydCBsb2dnZXJfdXRpbAoKbG9nZ2VyID0gbG9nZ2VyX3V0aWwuZ2V0X2xvZ2dlcigiR2V0IGNlcnRzIGJhc2VkIG9uIENBIikKCmRlZiBmZXRjaF9nYXRld2F5X2tleSgpOgogICAgJycnCiAgICBmZXRjaCB0aGUgZ2F0ZXdheSBrZXkgZnJvbSBhcHB2aWV3eCBjb25maWcgZmlsZQogICAgOnJldHVybjogYXBwdmlld3ggZ2F0ZXdheSBrZXkKICAgICcnJwogICAgY29uZl9jb250ZW50ID0ge30KICAgIGFic19wYXRoID0gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguYWJzcGF0aChfX2ZpbGVfXykpCiAgICAjIGxvZ2dlci5pbmZvKCdQQVRIJykKICAgICMgbG9nZ2VyLmluZm8oYWJzX3BhdGgpCiAgICBwcm9wX2ZpbGVfcGF0aCA9IGFic19wYXRoICsgIi8uLi9wcm9wZXJ0aWVzL2FwcHZpZXd4LnByb3BlcnRpZXMiCiAgICBwcm9wX2ZpbGUgPSBvcGVuKHByb3BfZmlsZV9wYXRoKQogICAgcHJvcF9maWxlX2xpbmVzID0gcHJvcF9maWxlLnJlYWRsaW5lcygpCiAgICBmb3IgbGluZSBpbiBwcm9wX2ZpbGVfbGluZXM6CiAgICAgICAgaWYgbGluZSBpcyBub3QgIlxuIiBhbmQgIkdBVEVXQVlfS0VZIiBpbiBsaW5lIG9yICJHQVRFV0FZX0JBU0VfVVJMIiBpbiBsaW5lOgogICAgICAgICAgICBjb25mX2NvbnRlbnRbbGluZS5zcGxpdCgiPSIpWzBdXSA9IGxpbmUuc3BsaXQoIj0iKVsxXS5yZXBsYWNlKCJcbiIsICIiKQogICAgcmV0dXJuIGNvbmZfY29udGVudFsnR0FURVdBWV9CQVNFX1VSTCddLCBjb25mX2NvbnRlbnRbJ0dBVEVXQVlfS0VZJ10KICAgIHByb3BfZmlsZS5jbG9zZSgpCgpkZWYgZmV0Y2hfYWxsX2NlcnRzX2Zyb21faW52ZW50b3J5KCk6CiAgICAnJycKICAgIGZldGNoIGFsbCB0aGUgY2VydGlmaWNhdGVzIGZyb20gdGhlIGludmVudG9yeQogICAgOnJldHVybjogTGlzdCBvZiBjZXJ0aWZpY2F0ZXMKICAgICcnJwoKICAgIGNlcnRzID0gW10KICAgIGNhdGVnb3J5X3R5cGVzID0gWyJzZXJ2ZXIiLCAiZGV2aWNlIiwgImNsaWVudCIsICJjb2RlU2lnbmluZyJdCiAgICBjZXJ0X2NuX3Nsbm8gPSBbXQogICAgc2tpcCA9IDAKICAgIG9idGFpbmVkUmVjb3JkcyA9IDEwMAoKICAgIHdoaWxlIG9idGFpbmVkUmVjb3JkcyA9PSAxMDA6CiAgICAgICAgdG90YWxfcmVjb3JkcywgY2VydF9saXN0LCBvYnRhaW5lZFJlY29yZHMgPSBnZXRDZXJ0aWZpY2F0ZSgnPCVzZXNzaW9uSWQlPicsIHNraXAsIGNhdGVnb3J5X3R5cGVzKQogICAgICAgIGNlcnRzLmV4dGVuZChjZXJ0X2xpc3QpCiAgICAgICAgc2tpcCA9IHNraXAgKyBvYnRhaW5lZFJlY29yZHMKICAgICAgICBpZiBvYnRhaW5lZFJlY29yZHMgPCAxMDA6CiAgICAgICAgICAgIGJyZWFrCgogICAgaWYgbm90IGNlcnRzOgogICAgICAgIEFWWDo6TE9HKCJObyBjZXJ0aWZpY2F0ZXMgdG8gZmV0Y2ggZnJvbSB0aGUgaW52ZW50b3J5IikKICAgIGxvZ2dlci5pbmZvKCdBTExfQ0VSVFMgLS0tPiAnICsgc3RyKGNlcnRzKSkKICAgIAogICAgZm9yIGNlcnRpZmljYXRlIGluIGNlcnRzOgogICAgICAgIGlmIGNlcnRpZmljYXRlLmdldCgiZXhwaXJ5U3RhdHVzIikgPT0gIlZhbGlkIiBhbmQgY2VydGlmaWNhdGUuZ2V0KCJjZXJ0aWZpY2F0ZUF1dGhvcml0eSIpICE9ICJPVEhFUlMiIGFuZCBjZXJ0aWZpY2F0ZS5nZXQoImdyb3VwIikgPT0gIjxjZXJ0X2dyb3VwPiIgYW5kIGNlcnRpZmljYXRlLmdldCgiY2VydGlmaWNhdGVBdXRob3JpdHkiKSA9PSAiPGNlcnRfYXV0aG9yaXR5PiI6CiAgICAgICAgICAgIGNlcnRfY25fc2xuby5hcHBlbmQoc3RyKGNlcnRpZmljYXRlLmdldCgiY29tbW9uTmFtZSIpKSArICJ8IiArc3RyKGNlcnRpZmljYXRlLmdldCgic2VyaWFsTnVtYmVyIikpKQogICAgCiAgICByZXR1cm4gY2VydF9jbl9zbG5vCiAgICAKICAgICAgICAKZGVmIGdldENlcnRpZmljYXRlKHNlc3Npb25faWQsIHN0YXJ0LCBjYXRlZ29yeSk6CiAgICAiIiIKICAgIEZ1bmN0aW9uIHRvIERvd25sb2FkIEtleSBjb250ZW50IGZyb20gQXBwVmlld1ggSW52ZW50b3J5CiAgICA6cGFyYW0gc2Vzc2lvbl9pZDogU2Vzc2lvbiBJZCBvZiBBcHBWaWV3WAogICAgOnBhcmFtIGNlcnRfaWQ6IHV1aWQgb2YgY2VydGlmaWNhdGUKICAgIDpwYXJhbSBmaWxlX3Bhc3N3b3JkOiBQYXNzd29yZCBvZiB0aGUga2V5IGZpbGUKICAgIDpyZXR1cm46IEtleSBDb250ZW50CiAgICAiIiIKICAgIGtleSA9IHN0cigpCiAgICBnYXRld2F5X3VybCwgZ2F0ZXdheV9rZXkgPSBmZXRjaF9nYXRld2F5X2tleSgpCiAgICBjd2QgPSBvcy5nZXRjd2QoKQogICAgdXJsID0gInt9YXZ4YXBpL2NlcnQtY2VydGlmaWNhdGUtaW52ZW50b3J5LWxpc3Q/Z3drZXk9e30mZ3dzb3VyY2U9ZXh0ZXJuYWwiLmZvcm1hdChnYXRld2F5X3VybCwgZ2F0ZXdheV9rZXkpCiAgICBoZWFkZXJzID0geyJzZXNzaW9uSWQiOiBzZXNzaW9uX2lkLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24ifQoKICAgICMgcGF5bG9hZCA9IHsicGF5bG9hZCI6eyJsb2ciOiBUcnVlLCJwYXNzd29yZCI6IGJhc2U2NC5iNjRlbmNvZGUoZmlsZV9wYXNzd29yZC5lbmNvZGUoKSkuZGVjb2RlKCksInV1SWQiOiBjZXJ0X2lkfX0KCiAgICBwYXlsb2FkID0geyJwYXlsb2FkIjogeyJza2lwIjogc3RhcnQsICJsaW1pdCI6IDEwMCwgInNvcnQiOiB7Il9pZCI6IC0xfSwgImNhdGVnb3JpZXMiOiBjYXRlZ29yeX19CgogICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKHBheWxvYWQpLCB2ZXJpZnk9RmFsc2UpCiAgICAjIGxvZ2dlci5pbmZvKCI9PT09PT09PT1DZXJ0aWZpY2F0ZVNlYXJjaD09PT09PT09PT0iKQogICAgIyBBVlg6OkxPRygiPT09PT09PT09Q2VydGlmaWNhdGVTZWFyY2g9PT09PT09PT09IikKICAgICMgbG9nZ2VyLmluZm8ocmVzcG9uc2UudGV4dCkKICAgICMgbG9nZ2VyLmluZm8ocmVzcG9uc2UucmVhc29uKQogICAgcmVzcG9uc2UgPSByZXNwb25zZS5qc29uKCkKICAgICMgcmV0dXJuIHR5cGUocmVzcG9uc2UpLCB0eXBlKHJlc3BvbnNlWydyZXNwb25zZSddKQogICAgbG9nZ2VyLmluZm8oc3RyKCItLS1SRVNQT05TRS0tLSIpKQogICAgbG9nZ2VyLmluZm8oc3RyKHJlc3BvbnNlKSkKICAgIHJldHVybiByZXNwb25zZS5nZXQoInJlc3BvbnNlIikuZ2V0KCJ0b3RhbFJlY29yZHMiKSwgcmVzcG9uc2UuZ2V0KCJyZXNwb25zZSIpLmdldCgiZGF0YSIpLCBsZW4oCiAgICAgICAgcmVzcG9uc2UuZ2V0KCJyZXNwb25zZSIpLmdldCgiZGF0YSIpKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGNlcnRfY29tbW9uX25hbWVfc2xubyA9IGZldGNoX2FsbF9jZXJ0c19mcm9tX2ludmVudG9yeSgpCiAgICBwcmludChqc29uLmR1bXBzKFt7ImNlcnRfbmFtZV9iYXNlZG9uX2NhIjp2YWx9IGZvciB2YWwgaW4gY2VydF9jb21tb25fbmFtZV9zbG5vXSkp",
        "_id" : null,
        "_keywords" : null
      } ],
      "accessType" : null,
      "parentTemplate" : null,
      "hiddenTemplate" : false,
      "groupData" : {
        "treeData" : [ ],
        "listData" : [ ]
      },
      "workflow_template_name" : null,
      "_keywords" : null
    },
    "configuration" : {
      "aclIdentifiers" : [ "super access" ],
      "permission" : [ "super access:submit" ],
      "skipFlow" : false,
      "emailConfiguration" : {
        "emailNotificationEnabled" : false,
        "createdNotificationConfig" : {
          "notifyUser" : false,
          "notifyTargetGroup" : false,
          "emailsList" : [ ]
        },
        "reviewedNotificationConfig" : {
          "notifyUser" : false,
          "notifyTargetGroup" : false,
          "emailsList" : [ ]
        },
        "submittedNotificationConfig" : {
          "notifyUser" : false,
          "notifyTargetGroup" : false,
          "emailsList" : [ ]
        },
        "rejectedNotificationConfig" : {
          "notifyUser" : false,
          "notifyTargetGroup" : false,
          "emailsList" : [ ]
        }
      },
      "multipleScenarioEnabled" : false,
      "maxScenarioCount" : 1,
      "enableSaveDraft" : true,
      "enableCancel" : true,
      "enableClose" : false,
      "enableBreakDown" : false,
      "labels" : {
        "submit" : "Submit",
        "reject" : "Back"
      },
      "enableAutoApprove" : false,
      "failoverState" : 2,
      "successState" : 1,
      "dynamicAuth" : null,
      "regexList" : null,
      "regexOperation" : null,
      "regexPattern" : null,
      "accessMode" : null
    },
    "data" : null,
    "api_list" : null
  }, {
    "uniqueId" : null,
    "directoryUniqueId" : null,
    "source" : null,
    "tags" : [ ],
    "userName" : null,
    "objectType" : "TaskDetails",
    "description" : "",
    "historyReferences" : [ ],
    "usedHistory" : null,
    "sampleInput" : null,
    "sampleOutput" : null,
    "contentTab" : null,
    "successiveTasks" : {
      "incoming" : [ {
        "taskId" : "createform_1",
        "taskName" : null,
        "subflowId" : "Ym3Jra2C",
        "parentSubflowId" : "DVWpo1UZ",
        "taskType" : "start",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ],
      "success" : [ {
        "taskId" : "workflow_stop_1",
        "taskName" : null,
        "subflowId" : "Ym3Jra2C",
        "parentSubflowId" : "DVWpo1UZ",
        "taskType" : "stop",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ]
    },
    "flowPathID" : null,
    "ignoredForStatusComputation" : false,
    "flowName" : "Certificate revokation",
    "subFlowID" : "Ym3Jra2C",
    "globalData" : null,
    "input" : [ {
      "name" : null,
      "key" : "reason_microsoft",
      "value" : "<%reason_microsoft%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "reason_microsoft",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "sessionId",
      "value" : "<%sessionId%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "sessionId",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "revokation_mode",
      "value" : "<%revokation_mode%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "revokation_mode",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "cert_name",
      "value" : "<%cert_name%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_name",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "reason",
      "value" : "<%reason%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "reason",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "cert_name_basedon_ca",
      "value" : "<%cert_name_basedon_ca%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_name_basedon_ca",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    } ],
    "notificationMessage" : {
      "0" : "",
      "1" : "",
      "2" : ""
    },
    "ancestor" : null,
    "metaData" : {
      "taskHeader" : "Script",
      "hide" : false,
      "lock" : false,
      "successState" : 1,
      "failoverState" : 2,
      "taskScope" : null,
      "hideFromStageView" : false,
      "mode" : "Developer",
      "nature" : "normal",
      "lowCodeTask" : false
    },
    "parentSubFlowID" : "DVWpo1UZ",
    "helpContent" : null,
    "name" : "",
    "syncExecution" : true,
    "_id" : null,
    "task_id" : "script_1",
    "task_name" : "Certificate Revokation script",
    "task_type" : "script",
    "task_category" : "script",
    "component_type" : "others",
    "setNullProperties" : true,
    "folderName" : "Cert+ OOB",
    "sub_group" : "script",
    "group_name" : "General",
    "viewable_type" : "custom",
    "scriptType" : "Python",
    "scriptContent" : "import sys\nimport requests\nimport json\n\nsys.path.append(AVX::DEPENDENCIES)\nsys.path.append(AVX::HELPER)\n\nimport appviewx\nimport logger_util\n\nrevokation_mode = '<%revokation_mode%>'\nnull = None\ntrue = True\nfalse = False\n\ndef fetch_gateway_key():\n    '''\n    fetch the gateway key from appviewx config file\n    :return: appviewx gateway key\n    '''\n    conf_content = {}\n    abs_path = os.path.dirname(os.path.abspath(__file__))\n    # logger.info('PATH')\n    # logger.info(abs_path)\n    prop_file_path = abs_path + \"/../properties/appviewx.properties\"\n    prop_file = open(prop_file_path)\n    prop_file_lines = prop_file.readlines()\n    for line in prop_file_lines:\n        if line is not \"\\n\" and \"GATEWAY_KEY\" in line or \"GATEWAY_BASE_URL\" in line:\n            conf_content[line.split(\"=\")[0]] = line.split(\"=\")[1].replace(\"\\n\", \"\")\n    return conf_content['GATEWAY_BASE_URL'], conf_content['GATEWAY_KEY']\n    prop_file.close()\n    \ndef get_uuid_from_commonname_slno(common_name, serial_number):\n    \"\"\"\n    Function to fetch uuid from common name and serial number\n    :param session_id: \n    :param common_name: certificate common name \n    :param serial_number: certificate serial number\n    :return: uuid of a certificate\n    \"\"\"\n    key = str()\n    gateway_url, gateway_key = fetch_gateway_key()\n    cwd = os.getcwd()\n    url = \"{}avxapi/cert-fetch-uuid-by-cn-serial-number?gwkey={}&gwsource=external\".format(gateway_url, gateway_key)\n    headers = {\"sessionId\": \"<%sessionId%>\" , \"Content-Type\": \"application/json\", \"Accept\": \"application/json\"}\n\n    payload = {\n                \"payload\":  {\n                            \"commonName\": common_name,\n                            \"serialNumber\": serial_number\n                            }\n            }\n\n    # AVX::LOG(\"PAYLOAD : \"+str(payload))\n    response = requests.post(url=url, headers=headers, data=json.dumps(payload), verify=False)\n    if response.status_code != 200:\n        AVX::LOG(\"The certificate with common name - \"+str(common_name) +\" has failed to revoke due to :\"+str(response.reason))\n        return ''\n    response = response.json()\n    # AVX::LOG(\"RESPONSE : \"+str(response))\n    return response.get(\"response\")\n    \n\ndef revoke_certificate_using_uuid(uuid,reason):\n    \"\"\"\n    Function to revoke certificate with certificate uuid\n    :param session_id: \n    :param uuid: uuid\n    :return: uuid of a certificate\n    \"\"\"\n    key = str()\n    gateway_url, gateway_key = fetch_gateway_key()\n    cwd = os.getcwd()\n    url = \"{}avxapi/cert-revoke-hv?gwkey={}&gwsource=external\".format(gateway_url, gateway_key)\n    headers = {\"sessionId\": \"<%sessionId%>\" , \"Content-Type\": \"application/json\", \"Accept\": \"application/json\"}\n\n    payload = { \"payload\" : {\"certificateUuid\":uuid,\"reason\":reason,\"comments\":\"\"} }\n\n    # AVX::LOG(\"PAYLOAD : \"+str(payload))\n    response = requests.post(url=url, headers=headers, data=json.dumps(payload), verify=False)\n    if response.status_code != 200:\n        AVX::LOG(\"Revokation failed due to : \"+str(response.reason))\n        return ''\n    response = response.json()\n    AVX::LOG(\"-------Certificate revokation triggered successfully-------\")\n    return response.get(\"response\")\n\n\ndef get_certificate(uuid):\n    \"\"\"\n    Function to revoke certificate with certificate uuid\n    :param uuid: uuid\n    :return: certificate content\n    \"\"\"\n    key = str()\n    gateway_url, gateway_key = fetch_gateway_key()\n    cwd = os.getcwd()\n    url = \"{}avxapi/cert-get-by-uuid?gwkey={}&gwsource=external\".format(gateway_url, gateway_key)\n    headers = {\"sessionId\": \"<%sessionId%>\" , \"Content-Type\": \"application/json\", \"Accept\": \"application/json\"}\n\n    payload = { \"payload\" : [uuid] }\n\n    # AVX::LOG(\"PAYLOAD : \"+str(payload))\n    response = requests.post(url=url, headers=headers, data=json.dumps(payload), verify=False)\n    if response.status_code != 200:\n        AVX::LOG(\"Revokation failed due to : \"+str(response.reason))\n        return ''\n    response = response.json()\n    return response.get(\"response\")\n\nif __name__ == \"__main__\":\n\n    cert_names_slno_list = str(\"<%cert_name_basedon_ca%>\").split(\",\")\n    certs_cn_slno = str(\"<%cert_name%>\").split(\",\")\n    uuid_list = []\n    \n    if \"<%reason%>\":\n        reason = \"<%reason%>\"\n    else:\n        reason = \"<%reason_microsoft%>\"\n    \n    if revokation_mode == \"Common name\" :\n        # uuid_list.append(get_uuid_from_commonname_slno(common_name, serial_number))\n        for cn_sl in certs_cn_slno:\n            common_name = cn_sl.split(\"|\")[0]\n            serial_number = cn_sl.split(\"|\")[1]\n            uuid_list.append(get_uuid_from_commonname_slno(common_name, serial_number))\n            AVX::LOG(str(uuid_list))\n        \n        for uuid in uuid_list:\n            if uuid:\n                revoke_certificate_using_uuid(uuid,reason)\n    else:\n        for cn_sl in cert_names_slno_list:\n            common_name = cn_sl.split('|')[0]\n            serial_number = cn = cn_sl.split('|')[1]\n            uuid_list.append(get_uuid_from_commonname_slno(common_name, serial_number))\n            # AVX::LOG(str(uuid_list))\n            for uuid in uuid_list:\n                if uuid:\n                    revoke_certificate_using_uuid(uuid,reason)\n    \n    # for uuid in uuid_list:\n    #     status = get_certificate(uuid)\n\n    AVX::OUTPUT({})",
    "http_method" : "POST",
    "action_id" : "run-script"
  } ],
  "subFlowID" : "Ym3Jra2C",
  "taskGlobalData" : {
    "workflow_stop_1" : [ ],
    "createform_1" : [ {
      "name" : "Reason",
      "key" : "reason_microsoft",
      "value" : "reason_microsoft",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "Key compromise,CA compromise,Affiliation changed,Superseded,Cessation of operation",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "reason_microsoft",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Common name",
      "key" : "common_name",
      "value" : "common_name",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "common_name",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Select revokation mode",
      "key" : "revokation_mode",
      "value" : "revokation_mode",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "Certificate authority,Common name",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "revokation_mode",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Certificate name",
      "key" : "cert_name",
      "value" : "cert_name",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_name",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Reason",
      "key" : "reason",
      "value" : "reason",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "reason",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Certificate name",
      "key" : "cert_name_basedon_ca",
      "value" : "cert_name_basedon_ca",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_name_basedon_ca",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Certificate group",
      "key" : "cert_group",
      "value" : "cert_group",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_group",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Certificate authority",
      "key" : "cert_authority",
      "value" : "cert_authority",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_authority",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    } ],
    "script_1" : [ ]
  },
  "type" : "cart",
  "level" : 0,
  "maxDepth" : 0,
  "input" : null,
  "workflowName" : "Certificate Revoke OOB",
  "description" : "",
  "flowName" : "Certificate revokation",
  "workflowType" : "Default",
  "subFlowType" : "Flow",
  "parentSubFlowID" : "DVWpo1UZ",
  "logs" : [ {
    "user" : null,
    "time" : 1596478781640,
    "message" : "Flow created successfully with : Certificate revokation for the workflow : Certificate Revoke OOB"
  } ],
  "workflowVersion" : "master"
}, {
  "tasks" : [ {
    "uniqueId" : null,
    "directoryUniqueId" : null,
    "source" : null,
    "tags" : [ ],
    "userName" : null,
    "objectType" : "TaskDetails",
    "description" : null,
    "historyReferences" : [ ],
    "usedHistory" : null,
    "sampleInput" : null,
    "sampleOutput" : null,
    "contentTab" : null,
    "successiveTasks" : {
      "incoming" : [ {
        "taskId" : "script_1",
        "taskName" : null,
        "subflowId" : "Ym3Jra2C",
        "parentSubflowId" : "DVWpo1UZ",
        "taskType" : "start",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ]
    },
    "flowPathID" : null,
    "ignoredForStatusComputation" : true,
    "flowName" : null,
    "subFlowID" : null,
    "globalData" : null,
    "input" : [ ],
    "notificationMessage" : null,
    "ancestor" : null,
    "metaData" : {
      "taskHeader" : "stop",
      "hide" : false,
      "lock" : false,
      "successState" : 1,
      "failoverState" : 2,
      "taskScope" : null,
      "hideFromStageView" : false,
      "mode" : "Developer",
      "nature" : null,
      "lowCodeTask" : false
    },
    "parentSubFlowID" : null,
    "helpContent" : null,
    "rules" : { },
    "cleanUpFlowDetails" : { },
    "subFlowDetails" : [ ],
    "associatedRollbackWorkOrderDetail" : null,
    "_id" : null,
    "task_id" : "workflow_stop_1",
    "task_name" : "Stop flow",
    "task_type" : "stop",
    "task_category" : "stop",
    "component_type" : "others",
    "setNullProperties" : true,
    "folderName" : null,
    "sub_group" : null,
    "group_name" : null,
    "viewable_type" : "custom"
  }, {
    "uniqueId" : null,
    "directoryUniqueId" : null,
    "source" : null,
    "tags" : [ ],
    "userName" : null,
    "objectType" : "TaskDetails",
    "description" : "",
    "historyReferences" : [ ],
    "usedHistory" : null,
    "sampleInput" : null,
    "sampleOutput" : null,
    "contentTab" : null,
    "successiveTasks" : {
      "incoming" : [ {
        "taskId" : "workflow_start_1",
        "taskName" : null,
        "subflowId" : "Ym3Jra2C",
        "parentSubflowId" : "DVWpo1UZ",
        "taskType" : "start",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ],
      "success" : [ {
        "taskId" : "script_1",
        "taskName" : null,
        "subflowId" : "Ym3Jra2C",
        "parentSubflowId" : "DVWpo1UZ",
        "taskType" : "script",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ]
    },
    "flowPathID" : null,
    "ignoredForStatusComputation" : false,
    "flowName" : null,
    "subFlowID" : null,
    "globalData" : null,
    "input" : [ ],
    "notificationMessage" : {
      "401" : ""
    },
    "ancestor" : null,
    "metaData" : {
      "taskHeader" : "Form",
      "hide" : false,
      "lock" : false,
      "successState" : 1,
      "failoverState" : 2,
      "taskScope" : null,
      "hideFromStageView" : false,
      "mode" : "Developer",
      "nature" : "normal",
      "lowCodeTask" : false
    },
    "parentSubFlowID" : null,
    "helpContent" : null,
    "dynamicAuth" : null,
    "regexList" : null,
    "regexOperation" : null,
    "regexPattern" : null,
    "accessMode" : null,
    "proceedProcess" : "Submit",
    "breakdownProcess" : "Back",
    "cancelProcess" : "Cancel",
    "saveDraftProcess" : "Save Draft",
    "closeProcess" : "Exit",
    "enableSaveDraft" : false,
    "enableCancel" : true,
    "enableClose" : false,
    "enableAutoApprove" : null,
    "enableBreakDown" : false,
    "availableGlobalData" : null,
    "_id" : null,
    "task_id" : "createform_1",
    "task_name" : "Select Common name or CA",
    "task_type" : "form",
    "task_category" : "form",
    "component_type" : "form",
    "setNullProperties" : true,
    "folderName" : "Cert+ OOB",
    "sub_group" : "form",
    "group_name" : "User interface",
    "viewable_type" : "default",
    "aclIdentifiers" : null,
    "template" : {
      "name" : "Select Common name or CA",
      "description" : null,
      "aclIdentifiers" : null,
      "fields" : [ {
        "labelName" : "Certificate group",
        "elementType" : "Dropdown",
        "values" : "",
        "fieldId" : "cert_group",
        "fieldScript" : "Fetch group",
        "aclFilter" : "None",
        "dependsOn" : "revokation_mode:Certificate authority",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : true,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Select revokation mode",
        "elementType" : "Hidden",
        "values" : "Certificate authority",
        "fieldId" : "revokation_mode",
        "fieldScript" : "",
        "aclFilter" : "None",
        "dependsOn" : "",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Certificate authority",
        "elementType" : "Dropdown",
        "values" : "",
        "fieldId" : "cert_authority",
        "fieldScript" : "Get certificate authority",
        "aclFilter" : "None",
        "dependsOn" : "revokation_mode:Certificate authority",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "CA Account",
        "elementType" : "Dropdown",
        "values" : "",
        "fieldId" : "ca_account",
        "fieldScript" : "Get CA account",
        "aclFilter" : "None",
        "dependsOn" : "",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Common name",
        "elementType" : "Text box",
        "values" : "",
        "fieldId" : "common_name",
        "fieldScript" : "Fetch certificates",
        "aclFilter" : "None",
        "dependsOn" : "revokation_mode:Common name",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : false,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Certificate name",
        "elementType" : "Multi select",
        "values" : "",
        "fieldId" : "cert_name",
        "fieldScript" : "",
        "aclFilter" : "None",
        "dependsOn" : "revokation_mode:Common name",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Certificate name",
        "elementType" : "Multi select",
        "values" : "",
        "fieldId" : "cert_name_basedon_ca",
        "fieldScript" : "Get certs based on CA",
        "aclFilter" : "None",
        "dependsOn" : "revokation_mode:Certificate authority",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Reason",
        "elementType" : "Text box",
        "values" : "",
        "fieldId" : "reason",
        "fieldScript" : "",
        "aclFilter" : "None",
        "dependsOn" : "cert_authority:DigiCert|cert_authority:Comodo Certificate Manager",
        "dataValidation" : "",
        "parent" : "",
        "help" : "This reason will applicable for all the certificates",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Reason",
        "elementType" : "Dropdown",
        "values" : "Key compromise,CA compromise,Affiliation changed,Superseded,Cessation of operation",
        "fieldId" : "reason_microsoft",
        "fieldScript" : "",
        "aclFilter" : "None",
        "dependsOn" : "cert_authority:Microsoft Enterprise",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      }, {
        "labelName" : "Reason",
        "elementType" : "Dropdown",
        "values" : "Key compromised,CA compromised,Privilege withdrawn,Unspecified",
        "fieldId" : "reason_appviewx",
        "fieldScript" : "",
        "aclFilter" : "None",
        "dependsOn" : "cert_authority:AppViewX",
        "dataValidation" : "",
        "parent" : "",
        "help" : "",
        "mandatory" : true,
        "predefinedRegex" : false,
        "notification" : null,
        "accessType" : "RW",
        "view" : "advanced",
        "permission" : "submit",
        "group" : "",
        "autoTrigger" : false,
        "global" : true,
        "fileName" : "",
        "downloadType" : null
      } ],
      "fieldScripts" : [ {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ ],
        "responseMapping" : null,
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Cancel request",
        "scriptData" : "",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ ],
        "responseMapping" : null,
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Discard request",
        "scriptData" : "",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ ],
        "responseMapping" : null,
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Submit request",
        "scriptData" : "",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ "cert_group" ],
        "responseMapping" : {
          "response" : {
            "" : ""
          }
        },
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Fetch group",
        "scriptData" : "aW1wb3J0IHN5cwppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHJlCmltcG9ydCBqc29uCnN5cy5wYXRoLmluc2VydCgwLEFWWDo6SEVMUEVSKQpzeXMucGF0aC5pbnNlcnQoMCxBVlg6OkRFUEVOREVOQ0lFUykKaW1wb3J0IGFwcHZpZXd4CmltcG9ydCBsb2dnZXJfdXRpbAoKCmxvZ2dlciA9IGxvZ2dlcl91dGlsLmdldF9sb2dnZXIoJ0dldCBDZXJ0aWZpY2F0ZSBncm91cCcpCgpkZWYgZ2V0Q2VydGlmaWNhdGVHcm91cCgpOgogICAgIiIiCiAgICBGdW5jdGlvbiB0byBGZXRjaCB0aGUgY29uZmlndXJlZCBjZXJ0aWZpY2F0ZSBncm91cAogICAgCiAgICA6cmV0dXJuOiBDZXJ0aWZpY2F0ZSBwb2xpY3kKICAgICIiIgogICAga2V5ID0gc3RyKCkKICAgIGdhdGV3YXlfdXJsLCBnYXRld2F5X2tleSA9IGZldGNoX2dhdGV3YXlfa2V5KCkKICAgIGN3ZCA9IG9zLmdldGN3ZCgpCiAgICB1cmwgPSAie31hdnhhcGkvY2VydC1ncm91cC1zZWFyY2g/Z3drZXk9e30mZ3dzb3VyY2U9ZXh0ZXJuYWwiLmZvcm1hdChnYXRld2F5X3VybCwgZ2F0ZXdheV9rZXkpCiAgICBoZWFkZXJzID0geyJzZXNzaW9uSWQiOiAiPCVzZXNzaW9uSWQlPiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiJ9CgogICAgcGF5bG9hZCA9IHsicGF5bG9hZCI6eyAic3RhcnRJbmRleCI6MCwiZGlzcGxheUxlbmd0aCI6MTAwLCJzZWFyY2hUZXh0IjoiIiwic29ydE9yZGVyIjoiYXNjIiwic29ydENvbHVtbiI6Im5hbWUifX0KICAgIAogICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKHBheWxvYWQpLCB2ZXJpZnk9RmFsc2UpCiAgICAKICAgIHJlc3BvbnNlID0gcmVzcG9uc2UuanNvbigpCiAgICBsb2dnZXIuaW5mbygnZ2V0Q2VydGlmaWNhdGVHcm91cCByZXNwb25zZSA6ICcrc3RyKHJlc3BvbnNlKSkKICAgIHJlc3BvbnNlID0gcmVzcG9uc2UuZ2V0KCJyZXNwb25zZSIpLmdldCgiZGF0YSIpCiAgICAKICAgIGdyb3VwcyA9IFtdCiAgICBmb3IgY2VydF9ncm91cCBpbiByZXNwb25zZToKICAgICAgICBncm91cHMuYXBwZW5kKGNlcnRfZ3JvdXAuZ2V0KCJuYW1lIikpCiAgICAKICAgIHJldHVybiBncm91cHMKCmRlZiBmZXRjaF9nYXRld2F5X2tleSgpOgogICAgJycnCiAgICBmZXRjaCB0aGUgZ2F0ZXdheSBrZXkgZnJvbSBhcHB2aWV3eCBjb25maWcgZmlsZQogICAgOnJldHVybjogYXBwdmlld3ggZ2F0ZXdheSBrZXkKICAgICcnJwogICAgY29uZl9jb250ZW50ID0ge30KICAgIGFic19wYXRoID0gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguYWJzcGF0aChfX2ZpbGVfXykpCiAgICBwcm9wX2ZpbGVfcGF0aCA9IGFic19wYXRoICsgIi8uLi9wcm9wZXJ0aWVzL2FwcHZpZXd4LnByb3BlcnRpZXMiCiAgICBwcm9wX2ZpbGUgPSBvcGVuKHByb3BfZmlsZV9wYXRoKQogICAgcHJvcF9maWxlX2xpbmVzID0gcHJvcF9maWxlLnJlYWRsaW5lcygpCiAgICBmb3IgbGluZSBpbiBwcm9wX2ZpbGVfbGluZXM6CiAgICAgICAgaWYgbGluZSBpcyBub3QgIlxuIiBhbmQgIkdBVEVXQVlfS0VZIiBpbiBsaW5lIG9yICJHQVRFV0FZX0JBU0VfVVJMIiBpbiBsaW5lOgogICAgICAgICAgICBjb25mX2NvbnRlbnRbbGluZS5zcGxpdCgiPSIpWzBdXSA9IGxpbmUuc3BsaXQoIj0iKVsxXS5yZXBsYWNlKCJcbiIsICIiKQogICAgcmV0dXJuIGNvbmZfY29udGVudFsnR0FURVdBWV9CQVNFX1VSTCddLCBjb25mX2NvbnRlbnRbJ0dBVEVXQVlfS0VZJ10KICAgIHByb3BfZmlsZS5jbG9zZSgpCgoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CgogICAgY2VydGlmaWNhdGVfZ3JvdXAgPSBnZXRDZXJ0aWZpY2F0ZUdyb3VwKCkKICAgIAogICAgZGF0YSA9ICBbeyJjZXJ0X2dyb3VwIjp2YWx9IGZvciB2YWwgaW4gY2VydGlmaWNhdGVfZ3JvdXBdCiAgICBpZiBkYXRhOgogICAgICAgIHByaW50KGpzb24uZHVtcHMoZGF0YSkpCiAgICBlbHNlOgogICAgICAgIHByaW50KGpzb24uZHVtcHMoeydlcnJvcic6ICdObyBDZXJ0aWZpY2F0ZSBHcm91cCBoYXMgYmVlbiBjb25maWd1cmVkJ30pKQoK",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ "cert_authority" ],
        "responseMapping" : {
          "response" : {
            "" : ""
          }
        },
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Get certificate authority",
        "scriptData" : "aW1wb3J0IHN5cwppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHJlCmltcG9ydCBqc29uCnN5cy5wYXRoLmluc2VydCgwLEFWWDo6SEVMUEVSKQpzeXMucGF0aC5pbnNlcnQoMCxBVlg6OkRFUEVOREVOQ0lFUykKaW1wb3J0IGFwcHZpZXd4CmltcG9ydCBsb2dnZXJfdXRpbAoKCmxvZ2dlciA9IGxvZ2dlcl91dGlsLmdldF9sb2dnZXIoJ0dldCBDZXJ0aWZpY2F0ZSBwb2xpY3knKQoKZGVmIGdldENlcnRpZmljYXRlUG9saWN5KCk6CiAgICAiIiIKICAgIEZ1bmN0aW9uIHRvIEZldGNoIHRoZSBjb25maWd1cmVkIGNlcnRpZmljYXRlIGdyb3VwCiAgICAKICAgIDpyZXR1cm46IENlcnRpZmljYXRlIHBvbGljeQogICAgIiIiCiAgICBrZXkgPSBzdHIoKQogICAgZ2F0ZXdheV91cmwsIGdhdGV3YXlfa2V5ID0gZmV0Y2hfZ2F0ZXdheV9rZXkoKQogICAgY3dkID0gb3MuZ2V0Y3dkKCkKICAgIGNhdCA9ICJzZXJ2ZXIiCiAgICAKICAgIGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJTZXJ2ZXIiOgogICAgICAgIGNhdCA9ICJzZXJ2ZXIiCiAgICBlbGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJDbGllbnQiOgogICAgICAgIGNhdCA9ICJjbGllbnQiCiAgICBlbGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJDb2RlU2lnbmluZyI6CiAgICAgICAgY2F0ID0gImNvZGVTaWduaW5nIgogICAgICAgIAogICAgdXJsID0gInt9YXZ4YXBpL2NlcnQtZ2V0LXBvbGljeS1ieS1ncm91cG5hbWU/Y2VydGlmaWNhdGVHcm91cE5hbWU9e30mY2VydGlmaWNhdGVDYXRlZ29yeT17fT9nd2tleT17fSZnd3NvdXJjZT1leHRlcm5hbCIuZm9ybWF0KGdhdGV3YXlfdXJsLCc8Y2VydF9ncm91cD4nLGNhdCAsIGdhdGV3YXlfa2V5KQogICAgaGVhZGVycyA9IHsic2Vzc2lvbklkIjogIjwlc2Vzc2lvbklkJT4iLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24ifQoKCiAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMsIHZlcmlmeT1GYWxzZSkKICAgIAogICAgcmVzcG9uc2UgPSByZXNwb25zZS5qc29uKCkKCiAgICByZXR1cm4gcmVzcG9uc2UuZ2V0KCJyZXNwb25zZSIpLmdldCgidHlwZSIpCgpkZWYgZmV0Y2hfZ2F0ZXdheV9rZXkoKToKICAgICcnJwogICAgZmV0Y2ggdGhlIGdhdGV3YXkga2V5IGZyb20gYXBwdmlld3ggY29uZmlnIGZpbGUKICAgIDpyZXR1cm46IGFwcHZpZXd4IGdhdGV3YXkga2V5CiAgICAnJycKICAgIGNvbmZfY29udGVudCA9IHt9CiAgICBhYnNfcGF0aCA9IG9zLnBhdGguZGlybmFtZShvcy5wYXRoLmFic3BhdGgoX19maWxlX18pKQogICAgcHJvcF9maWxlX3BhdGggPSBhYnNfcGF0aCArICIvLi4vcHJvcGVydGllcy9hcHB2aWV3eC5wcm9wZXJ0aWVzIgogICAgcHJvcF9maWxlID0gb3Blbihwcm9wX2ZpbGVfcGF0aCkKICAgIHByb3BfZmlsZV9saW5lcyA9IHByb3BfZmlsZS5yZWFkbGluZXMoKQogICAgZm9yIGxpbmUgaW4gcHJvcF9maWxlX2xpbmVzOgogICAgICAgIGlmIGxpbmUgaXMgbm90ICJcbiIgYW5kICJHQVRFV0FZX0tFWSIgaW4gbGluZSBvciAiR0FURVdBWV9CQVNFX1VSTCIgaW4gbGluZToKICAgICAgICAgICAgY29uZl9jb250ZW50W2xpbmUuc3BsaXQoIj0iKVswXV0gPSBsaW5lLnNwbGl0KCI9IilbMV0ucmVwbGFjZSgiXG4iLCAiIikKICAgIHJldHVybiBjb25mX2NvbnRlbnRbJ0dBVEVXQVlfQkFTRV9VUkwnXSwgY29uZl9jb250ZW50WydHQVRFV0FZX0tFWSddCiAgICBwcm9wX2ZpbGUuY2xvc2UoKQoKCgpkZWYgZ2V0Q2VydGlmaWNhdGVBdXRob3JpdHkoKToKICAgICIiIgogICAgRnVuY3Rpb24gdG8gRmV0Y2ggdGhlIGNvbmZpZ3VyZWQgY2VydGlmaWNhdGUgZ3JvdXAKICAgIAogICAgOnJldHVybjogQ2VydGlmaWNhdGUgcG9saWN5CiAgICAiIiIKICAgIGtleSA9IHN0cigpCiAgICBnYXRld2F5X3VybCwgZ2F0ZXdheV9rZXkgPSBmZXRjaF9nYXRld2F5X2tleSgpCiAgICBjd2QgPSBvcy5nZXRjd2QoKQogICAgY2F0ID0gInNlcnZlciIKICAgIGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJTZXJ2ZXIiOgogICAgICAgIGNhdCA9ICJzZXJ2ZXIiCiAgICBlbGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJDbGllbnQiOgogICAgICAgIGNhdCA9ICJjbGllbnQiCiAgICBlbGlmICc8Y2VydGlmaWNhdGVfcHJvZmlsZT4nID09ICJDb2RlU2lnbmluZyI6CiAgICAgICAgY2F0ID0gImNvZGVTaWduaW5nIgogICAgICAgIAogICAgdXJsID0gInt9YXZ4YXBpL2NlcnQtZ2V0LXBvbGljeS1ieS1ncm91cG5hbWU/Y2VydGlmaWNhdGVHcm91cE5hbWU9e30mY2VydGlmaWNhdGVDYXRlZ29yeT17fT9nd2tleT17fSZnd3NvdXJjZT1leHRlcm5hbCIuZm9ybWF0KGdhdGV3YXlfdXJsLCc8Y2VydF9ncm91cD4nLGNhdCAsIGdhdGV3YXlfa2V5KQogICAgaGVhZGVycyA9IHsic2Vzc2lvbklkIjogIjwlc2Vzc2lvbklkJT4iLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24ifQoKCiAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMsIHZlcmlmeT1GYWxzZSkKCiAgICByZXNwb25zZSA9IHJlc3BvbnNlLmpzb24oKQogICAgbG9nZ2VyLmluZm8oJ1JFUz4+JytzdHIocmVzcG9uc2UpKQogICAgCiAgICByZXNwb25zZSA9IHJlc3BvbnNlLmdldCgicmVzcG9uc2UiKS5nZXQoImNlcnRpZmljYXRlUG9saWN5Q2FBY2NvdW50RGV0YWlscyIpCiAgICAKICAgIGNhID0gW10KICAgIAogICAgZm9yIHJlcyBpbiByZXNwb25zZToKICAgICAgICBsb2dnZXIuaW5mbygiUkVTLS0tPDw8IitzdHIocmVzKSkKICAgICAgICBpZiByZXNbImNlcnRpZmljYXRlQXV0aG9yaXR5Il06CiAgICAgICAgICAgIGNhLmFwcGVuZChyZXMuZ2V0KCJjZXJ0aWZpY2F0ZUF1dGhvcml0eSIpKQogICAgcmV0dXJuIGNhCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKCiAgICBjZXJ0aWZpY2F0ZV9wb2xpY3kgPSBnZXRDZXJ0aWZpY2F0ZVBvbGljeSgpCiAgICBjZXJ0aWZpY2F0ZV9hdXRob3JpdHkgPSBnZXRDZXJ0aWZpY2F0ZUF1dGhvcml0eSgpCgogICAgaWYgY2VydGlmaWNhdGVfcG9saWN5OgogICAgICAgIGlmIGNlcnRpZmljYXRlX2F1dGhvcml0eToKICAgICAgICAgICAgZGF0YSA9IFt7ImNlcnRfYXV0aG9yaXR5Ijp2YWx9IGZvciB2YWwgaW4gY2VydGlmaWNhdGVfYXV0aG9yaXR5XQogICAgICAgICAgICBwcmludChqc29uLmR1bXBzKGRhdGEpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGpzb24uZHVtcHMoeydlcnJvcic6ICdObyBjZXJ0aWZpY2F0ZSBhdXRob3JpdHkgaXMgYXNzb2NpYXRlZCB3aXRoIHRoaXMgQ2VydGlmaWNhdGUgR3JvdXAnfSkpCiAgICBlbHNlOgogICAgICAgIHByaW50KGpzb24uZHVtcHMoeydlcnJvcic6ICdObyBwb2xpY3kgaXMgYXNzb2NpYXRlZCB3aXRoIHRoaXMgQ2VydGlmaWNhdGUgR3JvdXAnfSkpCg==",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ "common_name" ],
        "responseMapping" : {
          "response" : {
            "" : ""
          }
        },
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Fetch certificates",
        "scriptData" : "aW1wb3J0IHN5cwppbXBvcnQganNvbgppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IG9zCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCmZyb20gZGF0ZXRpbWUgaW1wb3J0IHRpbWVkZWx0YQpmcm9tIGNvbmZpZ29iaiBpbXBvcnQgQ29uZmlnT2JqCgp0cnVlID0gVHJ1ZQpmYWxzZSA9IEZhbHNlCm51bGwgPSBOb25lCgpzZWxlY3RfY2VydF91c2luZyA9ICc8c2VsZWN0X2NlcnRfdXNpbmc+JwpzZWxlY3RfY2EgPSAnPGNlcnRfYXV0aG9yaXR5PicKY2VydF9ncm91cCA9ICc8YXNzaWduX2dyb3VwPicKCnN5cy5wYXRoLmluc2VydCgwLEFWWDo6SEVMUEVSKQpzeXMucGF0aC5pbnNlcnQoMCxBVlg6OkRFUEVOREVOQ0lFUykKCmltcG9ydCBsb2dnZXJfdXRpbApsb2dnZXIgPSBsb2dnZXJfdXRpbC5nZXRfbG9nZ2VyKCJDZXJ0IFJlbmV3IE9PQiIpCgpkZWYgZmV0Y2hfZ2F0ZXdheV9rZXkoKToKICAgIGNvbmZfY29udGVudCA9IHt9CiAgICBhYnNfcGF0aCA9IG9zLnBhdGguZGlybmFtZShvcy5wYXRoLmFic3BhdGgoX19maWxlX18pKQogICAgcHJvcF9maWxlX3BhdGggPSBhYnNfcGF0aCArICIvLi4vcHJvcGVydGllcy9hcHB2aWV3eC5wcm9wZXJ0aWVzIgogICAgY29uZmlnID0gQ29uZmlnT2JqKHByb3BfZmlsZV9wYXRoKQogICAgcmV0dXJuIGNvbmZpZ1snR0FURVdBWV9CQVNFX1VSTCddLCBjb25maWdbJ0dBVEVXQVlfS0VZJ10KCgpkZWYgZ2V0X2NlcnRzX2Jhc2VkX29uX2NuKCk6CiAgICBjYXRlZ29yeV90eXBlcyA9IFsiU2VydmVyIiwgIkNsaWVudCIsICJEZXZpY2UiLCAiQ29kZSBTaWduaW5nIl0KICAgIGNlcnRfbGlzdCA9IFtdCiAgICBmb3IgY2F0ZWdvcnkgaW4gY2F0ZWdvcnlfdHlwZXM6CiAgICAgICAgb2J0YWluZWRSZWNvcmRzID0gMTAwCiAgICAgICAgc3RhcnQgPSAxCiAgICAgICAgd2hpbGUgb2J0YWluZWRSZWNvcmRzID09IDEwMDoKICAgICAgICAgICAgY29tbW9uX25hbWVfbGlzdCwgb2J0YWluZWRSZWNvcmRzID0gZ2V0X2NlcnRzKGNhdGVnb3J5LHN0YXJ0KQogICAgICAgICAgICBjZXJ0X2xpc3QuZXh0ZW5kKGNvbW1vbl9uYW1lX2xpc3QpCiAgICAgICAgICAgIHN0YXJ0ICs9IDEwMAogICAgcmV0dXJuIGNlcnRfbGlzdAoKCmRlZiBnZXRfY2VydHMoY2F0ZWdvcnksIHN0YXJ0KToKICAgIGNvbW1vbl9uYW1lID0gJzxjb21tb25fbmFtZT4nCiAgICBjb21tb25fbmFtZV9saXN0ID0gW10KICAgIGdhdGV3YXlfdXJsLCBnYXRld2F5X2tleSA9IGZldGNoX2dhdGV3YXlfa2V5KCkKICAgIHVybCA9ICJ7fWF2eGFwaS9jZXJ0aWZpY2F0ZS9zZWFyY2g/Z3drZXk9e30mZ3dzb3VyY2U9ZXh0ZXJuYWwiLmZvcm1hdCgKICAgICAgICBnYXRld2F5X3VybCwgZ2F0ZXdheV9rZXkpCiAgICBoZWFkZXJzID0gewogICAgICAgICJzZXNzaW9uSWQiOiAnPCVzZXNzaW9uSWQlPicsCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iCiAgICB9CiAgICBwYXlsb2FkID0gewogICAgICAgICJpbnB1dCI6IHsKICAgICAgICAgICAgImNvbW1vbk5hbWUiOiBjb21tb25fbmFtZSwKICAgICAgICAgICAgImNhdGVnb3J5IjogY2F0ZWdvcnkKICAgICAgICB9LAogICAgICAgICJmaWx0ZXIiOiB7CiAgICAgICAgICAgICJzdGFydCI6IHN0YXJ0LAogICAgICAgICAgICAiY29tbW9uTmFtZSI6IGNvbW1vbl9uYW1lCiAgICAgICAgfQogICAgfQogICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KAogICAgICAgIHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKHBheWxvYWQpLCB2ZXJpZnk9RmFsc2UpCiAgICBsb2dnZXIuaW5mbyhzdHIocmVzcG9uc2UuanNvbigpKSkKICAgIGNlcnRzID0gcmVzcG9uc2UuanNvbigpLmdldCgicmVzcG9uc2UiKS5nZXQoInJlc3BvbnNlIikuZ2V0KCJvYmplY3RzIikKICAgIG9idGFpbmVkX3JlY29yZHMgPSByZXNwb25zZS5qc29uKCkuZ2V0KCJyZXNwb25zZSIpLmdldCgicmVzcG9uc2UiKS5nZXQoCiAgICAgICAgIm9idGFpbmVkUmVjb3JkcyIpCiAgICBmb3IgY2VydCBpbiBjZXJ0czoKICAgICAgICBjbiA9IGNlcnRbJ2NvbW1vbk5hbWUnXSArICd8JyArIGNlcnRbJ3NlcmlhbE51bWJlciddCiAgICAgICAgY29tbW9uX25hbWVfbGlzdC5hcHBlbmQoY24pCiAgICByZXR1cm4gY29tbW9uX25hbWVfbGlzdCwgb2J0YWluZWRfcmVjb3JkcwoKZGVmIGdldF9hbGxfY2VydHMoY2F0ZWdvcnksIHN0YXJ0KToKICAgIGNvbW1vbl9uYW1lID0gJzxjb21tb25fbmFtZT4nCiAgICBjb21tb25fbmFtZV9saXN0ID0gW10KICAgIGdhdGV3YXlfdXJsLCBnYXRld2F5X2tleSA9IGZldGNoX2dhdGV3YXlfa2V5KCkKICAgIHVybCA9ICJ7fWF2eGFwaS9jZXJ0LWNlcnRpZmljYXRlLWludmVudG9yeS1saXN0P2d3a2V5PXt9Jmd3c291cmNlPWV4dGVybmFsIi5mb3JtYXQoCiAgICAgICAgZ2F0ZXdheV91cmwsIGdhdGV3YXlfa2V5KQogICAgaGVhZGVycyA9IHsKICAgICAgICAic2Vzc2lvbklkIjogJzwlc2Vzc2lvbklkJT4nLAogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIgogICAgfQogICAgcGF5bG9hZCA9IHsKICAgICAgICAicGF5bG9hZCI6IHsKICAgICAgICAgICAgInNraXAiOiBzdGFydCwKICAgICAgICAgICAgImxpbWl0IjogMTAwLAogICAgICAgICAgICAic29ydCI6IHsiX2lkIjogLTF9LAogICAgICAgICAgICAic3RhcnQiOiBzdGFydCwKICAgICAgICAgICAgImNhdGVnb3JpZXMiOiBjYXRlZ29yeQogICAgICAgIH0KICAgIH0KICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCgKICAgICAgICB1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9anNvbi5kdW1wcyhwYXlsb2FkKSwgdmVyaWZ5PUZhbHNlKQogICAgY2VydHMgPSByZXNwb25zZS5qc29uKCkuZ2V0KCJyZXNwb25zZSIpLmdldCgiZGF0YSIpCiAgICBvYnRhaW5lZF9yZWNvcmRzID0gbGVuKHJlc3BvbnNlLmpzb24oKS5nZXQoInJlc3BvbnNlIikuZ2V0KCJkYXRhIikpCiAgICAKICAgIGZvciBjZXJ0IGluIGNlcnRzOgogICAgICAgIGlmIGNlcnRbJ2dyb3VwJ10gPT0gY2VydF9ncm91cCBhbmQgY2VydFsnY2VydGlmaWNhdGVBdXRob3JpdHknXSA9PSBzZWxlY3RfY2EgYW5kIGNlcnRbJ3ByaXZhdGVrZXlBdmFsaWFibGUnXSA9PSBUcnVlOgogICAgICAgICAgICBjbiA9IGNlcnRbJ2NvbW1vbk5hbWUnXSArICd8JyArIGNlcnRbJ3NlcmlhbE51bWJlciddCiAgICAgICAgICAgIGNvbW1vbl9uYW1lX2xpc3QuYXBwZW5kKGNuKQogICAgcmV0dXJuIGNvbW1vbl9uYW1lX2xpc3QsIG9idGFpbmVkX3JlY29yZHMKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICAjIG9wZXJhdGlvbl90eXBlID0gJycKICAgICMgb3Bfd2l0aG91dF9yZWlzc3VlID0gJzxvcF90eXBlX3JlaXNzdWU+JwogICAgIyBvcF93aXRoX3JlaXNzdWUgPSAnPG9wX3R5cGU+JwogICAgIyBjYXRlZ29yeSA9IFsic2VydmVyIiwgImRldmljZSIsICJjbGllbnQiLCAiY29kZVNpZ25pbmciXQogICAgCiAgICBjZXJ0aWZpY2F0ZXMgPSBbXQogICAgCiAgICBjZXJ0aWZpY2F0ZXMuZXh0ZW5kKGdldF9jZXJ0c19iYXNlZF9vbl9jbigpKQoKICAgIGlmIGxlbihjZXJ0aWZpY2F0ZXMpID09IDA6CiAgICAgICAgcHJpbnQoanNvbi5kdW1wcyh7ImVycm9yIjoiTm8gY2VydGlmaWNhdGVzIGZvdW5kIn0pKQogICAgZWxzZToKICAgICAgICBkYXRhID0gW3siY2VydF9uYW1lIjogdmFsfSBmb3IgdmFsIGluIGNlcnRpZmljYXRlc10KICAgICAgICBwcmludChqc29uLmR1bXBzKGRhdGEpKQ==",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ "cert_name_basedon_ca" ],
        "responseMapping" : {
          "response" : {
            "" : ""
          }
        },
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Get certs based on CA",
        "scriptData" : "aW1wb3J0IHN5cwppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IGpzb24KZnJvbSBkYXRldGltZSBpbXBvcnQgdGltZWRlbHRhCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGUKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKCnN5cy5wYXRoLmFwcGVuZChBVlg6OkRFUEVOREVOQ0lFUykKc3lzLnBhdGguYXBwZW5kKEFWWDo6SEVMUEVSKQoKaW1wb3J0IGFwcHZpZXd4CmltcG9ydCBsb2dnZXJfdXRpbAoKbG9nZ2VyID0gbG9nZ2VyX3V0aWwuZ2V0X2xvZ2dlcigiR2V0IGNlcnRzIGJhc2VkIG9uIENBIikKCmRlZiBmZXRjaF9nYXRld2F5X2tleSgpOgogICAgJycnCiAgICBmZXRjaCB0aGUgZ2F0ZXdheSBrZXkgZnJvbSBhcHB2aWV3eCBjb25maWcgZmlsZQogICAgOnJldHVybjogYXBwdmlld3ggZ2F0ZXdheSBrZXkKICAgICcnJwogICAgY29uZl9jb250ZW50ID0ge30KICAgIGFic19wYXRoID0gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguYWJzcGF0aChfX2ZpbGVfXykpCgogICAgcHJvcF9maWxlX3BhdGggPSBhYnNfcGF0aCArICIvLi4vcHJvcGVydGllcy9hcHB2aWV3eC5wcm9wZXJ0aWVzIgogICAgcHJvcF9maWxlID0gb3Blbihwcm9wX2ZpbGVfcGF0aCkKICAgIHByb3BfZmlsZV9saW5lcyA9IHByb3BfZmlsZS5yZWFkbGluZXMoKQogICAgZm9yIGxpbmUgaW4gcHJvcF9maWxlX2xpbmVzOgogICAgICAgIGlmIGxpbmUgaXMgbm90ICJcbiIgYW5kICJHQVRFV0FZX0tFWSIgaW4gbGluZSBvciAiR0FURVdBWV9CQVNFX1VSTCIgaW4gbGluZToKICAgICAgICAgICAgY29uZl9jb250ZW50W2xpbmUuc3BsaXQoIj0iKVswXV0gPSBsaW5lLnNwbGl0KCI9IilbMV0ucmVwbGFjZSgiXG4iLCAiIikKICAgIHJldHVybiBjb25mX2NvbnRlbnRbJ0dBVEVXQVlfQkFTRV9VUkwnXSwgY29uZl9jb250ZW50WydHQVRFV0FZX0tFWSddCiAgICBwcm9wX2ZpbGUuY2xvc2UoKQoKZGVmIGZldGNoX2FsbF9jZXJ0c19mcm9tX2ludmVudG9yeSgpOgogICAgJycnCiAgICBmZXRjaCBhbGwgdGhlIGNlcnRpZmljYXRlcyBmcm9tIHRoZSBpbnZlbnRvcnkKICAgIDpyZXR1cm46IExpc3Qgb2YgY2VydGlmaWNhdGVzCiAgICAnJycKCiAgICBjZXJ0cyA9IFtdCiAgICBjYXRlZ29yeV90eXBlcyA9IFsic2VydmVyIiwgImRldmljZSIsICJjbGllbnQiLCAiY29kZVNpZ25pbmciXQogICAgY2VydF9jbl9zbG5vID0gW10KICAgIHNraXAgPSAwCiAgICBvYnRhaW5lZFJlY29yZHMgPSAxMDAKCiAgICB3aGlsZSBvYnRhaW5lZFJlY29yZHMgPT0gMTAwOgogICAgICAgIHRvdGFsX3JlY29yZHMsIGNlcnRfbGlzdCwgb2J0YWluZWRSZWNvcmRzID0gZ2V0Q2VydGlmaWNhdGUoJzwlc2Vzc2lvbklkJT4nLCBza2lwLCBjYXRlZ29yeV90eXBlcykKICAgICAgICBjZXJ0cy5leHRlbmQoY2VydF9saXN0KQogICAgICAgIHNraXAgPSBza2lwICsgb2J0YWluZWRSZWNvcmRzCiAgICAgICAgaWYgb2J0YWluZWRSZWNvcmRzIDwgMTAwOgogICAgICAgICAgICBicmVhawoKICAgIGlmIG5vdCBjZXJ0czoKICAgICAgICBBVlg6OkxPRygiTm8gY2VydGlmaWNhdGVzIHRvIGZldGNoIGZyb20gdGhlIGludmVudG9yeSIpCgogICAgZm9yIGNlcnRpZmljYXRlIGluIGNlcnRzOgogICAgICAgIGlmIGNlcnRpZmljYXRlLmdldCgiZXhwaXJ5U3RhdHVzIikgPT0gIlZhbGlkIiBhbmQgY2VydGlmaWNhdGUuZ2V0KCJjZXJ0aWZpY2F0ZUF1dGhvcml0eSIpICE9ICJPVEhFUlMiIGFuZCBjZXJ0aWZpY2F0ZS5nZXQoImdyb3VwIikgPT0gIjxjZXJ0X2dyb3VwPiIgYW5kIGNlcnRpZmljYXRlLmdldCgiY2VydGlmaWNhdGVBdXRob3JpdHkiKSA9PSAiPGNlcnRfYXV0aG9yaXR5PiI6CiAgICAgICAgICAgIGNlcnRfY25fc2xuby5hcHBlbmQoc3RyKGNlcnRpZmljYXRlLmdldCgiY29tbW9uTmFtZSIpKSArICJ8IiArc3RyKGNlcnRpZmljYXRlLmdldCgic2VyaWFsTnVtYmVyIikpKQogICAgCiAgICByZXR1cm4gY2VydF9jbl9zbG5vCiAgICAKICAgICAgICAKZGVmIGdldENlcnRpZmljYXRlKHNlc3Npb25faWQsIHN0YXJ0LCBjYXRlZ29yeSk6CiAgICAiIiIKICAgIEZ1bmN0aW9uIHRvIERvd25sb2FkIEtleSBjb250ZW50IGZyb20gQXBwVmlld1ggSW52ZW50b3J5CiAgICA6cGFyYW0gc2Vzc2lvbl9pZDogU2Vzc2lvbiBJZCBvZiBBcHBWaWV3WAogICAgOnBhcmFtIGNlcnRfaWQ6IHV1aWQgb2YgY2VydGlmaWNhdGUKICAgIDpwYXJhbSBmaWxlX3Bhc3N3b3JkOiBQYXNzd29yZCBvZiB0aGUga2V5IGZpbGUKICAgIDpyZXR1cm46IEtleSBDb250ZW50CiAgICAiIiIKICAgIGtleSA9IHN0cigpCiAgICBnYXRld2F5X3VybCwgZ2F0ZXdheV9rZXkgPSBmZXRjaF9nYXRld2F5X2tleSgpCiAgICBjd2QgPSBvcy5nZXRjd2QoKQogICAgdXJsID0gInt9YXZ4YXBpL2NlcnQtY2VydGlmaWNhdGUtaW52ZW50b3J5LWxpc3Q/Z3drZXk9e30mZ3dzb3VyY2U9ZXh0ZXJuYWwiLmZvcm1hdChnYXRld2F5X3VybCwgZ2F0ZXdheV9rZXkpCiAgICBoZWFkZXJzID0geyJzZXNzaW9uSWQiOiBzZXNzaW9uX2lkLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24ifQoKCiAgICBwYXlsb2FkID0geyJwYXlsb2FkIjogeyJza2lwIjogc3RhcnQsICJsaW1pdCI6IDEwMCwgInNvcnQiOiB7Il9pZCI6IC0xfSwgImNhdGVnb3JpZXMiOiBjYXRlZ29yeX19CgogICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKHBheWxvYWQpLCB2ZXJpZnk9RmFsc2UpCiAgICAKICAgIHJlc3BvbnNlID0gcmVzcG9uc2UuanNvbigpCiAgICAKICAgIHJldHVybiByZXNwb25zZS5nZXQoInJlc3BvbnNlIikuZ2V0KCJ0b3RhbFJlY29yZHMiKSwgcmVzcG9uc2UuZ2V0KCJyZXNwb25zZSIpLmdldCgiZGF0YSIpLCBsZW4oCiAgICAgICAgcmVzcG9uc2UuZ2V0KCJyZXNwb25zZSIpLmdldCgiZGF0YSIpKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGNlcnRfY29tbW9uX25hbWVfc2xubyA9IGZldGNoX2FsbF9jZXJ0c19mcm9tX2ludmVudG9yeSgpCiAgICBwcmludChqc29uLmR1bXBzKFt7ImNlcnRfbmFtZV9iYXNlZG9uX2NhIjp2YWx9IGZvciB2YWwgaW4gY2VydF9jb21tb25fbmFtZV9zbG5vXSkp",
        "_id" : null,
        "_keywords" : null
      }, {
        "name" : null,
        "description" : null,
        "version" : null,
        "type" : "script",
        "fieldIds" : [ "ca_account" ],
        "responseMapping" : {
          "response" : {
            "" : ""
          }
        },
        "historyReferences" : [ ],
        "usedHistory" : null,
        "scriptName" : "Get CA account",
        "scriptData" : "aW1wb3J0IHN5cwppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHJlCmltcG9ydCBqc29uCnN5cy5wYXRoLmluc2VydCgwLEFWWDo6SEVMUEVSKQpzeXMucGF0aC5pbnNlcnQoMCxBVlg6OkRFUEVOREVOQ0lFUykKaW1wb3J0IGFwcHZpZXd4CmltcG9ydCBsb2dnZXJfdXRpbApudWxsID0gTm9uZQp0cnVlID0gVHJ1ZQpmYWxzZSA9IEZhbHNlCgpsb2dnZXIgPSBsb2dnZXJfdXRpbC5nZXRfbG9nZ2VyKCdHZXQgQ2VydGlmaWNhdGUgcG9saWN5JykKCmRlZiBnZXRfY2FfYWNjb3VudCgpOgogICAgIiIiCiAgICBGdW5jdGlvbiB0byBGZXRjaCB0aGUgY29uZmlndXJlZCBjZXJ0aWZpY2F0ZSBncm91cAogICAgCiAgICA6cmV0dXJuOiBDZXJ0aWZpY2F0ZSBwb2xpY3kKICAgICIiIgogICAgZ2F0ZXdheV91cmwsIGdhdGV3YXlfa2V5ID0gZmV0Y2hfZ2F0ZXdheV9rZXkoKQogICAgY2F0ID0gJ3NlcnZlcicKICAgIGxvZ2dlci5pbmZvKCJJbnNpZGUgR2V0IENBIGFjY291bnQgOiIrc3RyKGNhdCkpCiAgICBpZiAnPCVjZXJ0aWZpY2F0ZV9wcm9maWxlJT4nID09ICdTZXJ2ZXInOgogICAgICAgIGNhdCA9ICdzZXJ2ZXInCiAgICBlbGlmICc8JWNlcnRpZmljYXRlX3Byb2ZpbGUlPicgPT0gJ0NsaWVudCc6CiAgICAgICAgY2F0ID0gJ2NsaWVudCcKICAgIGVsaWYgJzwlY2VydGlmaWNhdGVfcHJvZmlsZSU+JyA9PSAnQ29kZVNpZ25pbmcnOgogICAgICAgIGNhdCA9ICdDb2RlIFNpZ25pbmcnCiAgICAgICAgCiAgICB1cmwgPSAie31hdnhhcGkvY2VydC1jYS1zZXR0aW5ncy1nZXRieWNhbmFtZT9jZXJ0aWZpY2F0ZUF1dGhvcml0eT17fSZjZXJ0aWZpY2F0ZUNhdGVnb3J5PXt9JmNlcnRpZmljYXRlR3JvdXA9e30mZ3drZXk9e30mZ3dzb3VyY2U9ZXh0ZXJuYWwiLmZvcm1hdChnYXRld2F5X3VybCwnPGNlcnRfYXV0aG9yaXR5PicsIGNhdCwgJzxjZXJ0X2dyb3VwPicsZ2F0ZXdheV9rZXkpCgogICAgaGVhZGVycyA9IHsic2Vzc2lvbklkIjogIjwlc2Vzc2lvbklkJT4iLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24ifQoKICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywgdmVyaWZ5PUZhbHNlKQogICAgCiAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSAhPSAyMDA6CiAgICAgICAgcHJpbnQoanNvbi5kdW1wcyh7J2Vycm9yJzogJ05vIENBIEFjY291bnQgaGFzIGJlZW4gY29uZmlndXJlZCd9KSkKICAgIHJlc3BvbnNlID0gcmVzcG9uc2UuanNvbigpCiAgICAKICAgIGNhX2xpc3QgPSBbXQogICAgCiAgICBmb3IgY2VydF9wb2xpY3kgaW4gcmVzcG9uc2UuZ2V0KCJyZXNwb25zZSIpOgogICAgCWlmIGNlcnRfcG9saWN5LmdldCgiY2VydGlmaWNhdGVBdXRob3JpdHkiKSA9PSAiPGNlcnRfYXV0aG9yaXR5PiI6CiAgICAJICAgIGNhX2xpc3QuYXBwZW5kKGNlcnRfcG9saWN5LmdldCgibmFtZSIpKQogICAgCiAgICBpZiBub3QgY2FfbGlzdDoKICAgICAgICBwcmludChqc29uLmR1bXBzKHsnZXJyb3InOiAnTm8gQ0EgQWNjb3VudCBoYXMgYmVlbiBjb25maWd1cmVkJ30pKQogICAgcmV0dXJuIGNhX2xpc3QKCmRlZiBmZXRjaF9nYXRld2F5X2tleSgpOgogICAgJycnCiAgICBmZXRjaCB0aGUgZ2F0ZXdheSBrZXkgZnJvbSBhcHB2aWV3eCBjb25maWcgZmlsZQogICAgOnJldHVybjogYXBwdmlld3ggZ2F0ZXdheSBrZXkKICAgICcnJwogICAgY29uZl9jb250ZW50ID0ge30KICAgIGFic19wYXRoID0gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguYWJzcGF0aChfX2ZpbGVfXykpCiAgICBwcm9wX2ZpbGVfcGF0aCA9IGFic19wYXRoICsgIi8uLi9wcm9wZXJ0aWVzL2FwcHZpZXd4LnByb3BlcnRpZXMiCiAgICBwcm9wX2ZpbGUgPSBvcGVuKHByb3BfZmlsZV9wYXRoKQogICAgcHJvcF9maWxlX2xpbmVzID0gcHJvcF9maWxlLnJlYWRsaW5lcygpCiAgICBmb3IgbGluZSBpbiBwcm9wX2ZpbGVfbGluZXM6CiAgICAgICAgaWYgbGluZSBpcyBub3QgIlxuIiBhbmQgIkdBVEVXQVlfS0VZIiBpbiBsaW5lIG9yICJHQVRFV0FZX0JBU0VfVVJMIiBpbiBsaW5lOgogICAgICAgICAgICBjb25mX2NvbnRlbnRbbGluZS5zcGxpdCgiPSIpWzBdXSA9IGxpbmUuc3BsaXQoIj0iKVsxXS5yZXBsYWNlKCJcbiIsICIiKQogICAgcmV0dXJuIGNvbmZfY29udGVudFsnR0FURVdBWV9CQVNFX1VSTCddLCBjb25mX2NvbnRlbnRbJ0dBVEVXQVlfS0VZJ10KICAgIHByb3BfZmlsZS5jbG9zZSgpCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKCiAgICBjYV9hY2NvdW50ID0gZ2V0X2NhX2FjY291bnQoKQogICAgaWYgY2FfYWNjb3VudDoKICAgICAgICBsb2dnZXIuaW5mbyhzdHIodHlwZShjYV9hY2NvdW50KSkpCiAgICAgICAgZGF0YSA9IFt7ImNhX2FjY291bnQiOnZhbH0gZm9yIHZhbCBpbiBjYV9hY2NvdW50XQogICAgICAgIHByaW50KGpzb24uZHVtcHMoZGF0YSkpCiAgICBlbHNlOgogICAgICAgIHByaW50KGpzb24uZHVtcHMoeydlcnJvcic6ICdObyBDQSBBY2NvdW50IGhhcyBiZWVuIGNvbmZpZ3VyZWQgd2l0aCB0aGlzIGNlcnRpZmljYXRlIGF1dGhvcml0eSd9KSk=",
        "_id" : null,
        "_keywords" : null
      } ],
      "accessType" : null,
      "parentTemplate" : null,
      "hiddenTemplate" : false,
      "groupData" : {
        "treeData" : [ ],
        "listData" : [ ]
      },
      "workflow_template_name" : null,
      "_keywords" : null
    },
    "configuration" : {
      "aclIdentifiers" : [ "super access" ],
      "permission" : [ "super access:submit" ],
      "skipFlow" : false,
      "emailConfiguration" : {
        "emailNotificationEnabled" : false,
        "createdNotificationConfig" : {
          "notifyUser" : false,
          "notifyTargetGroup" : false,
          "emailsList" : [ ]
        },
        "reviewedNotificationConfig" : {
          "notifyUser" : false,
          "notifyTargetGroup" : false,
          "emailsList" : [ ]
        },
        "submittedNotificationConfig" : {
          "notifyUser" : false,
          "notifyTargetGroup" : false,
          "emailsList" : [ ]
        },
        "rejectedNotificationConfig" : {
          "notifyUser" : false,
          "notifyTargetGroup" : false,
          "emailsList" : [ ]
        }
      },
      "multipleScenarioEnabled" : false,
      "maxScenarioCount" : 1,
      "enableSaveDraft" : true,
      "enableCancel" : true,
      "enableClose" : false,
      "enableBreakDown" : false,
      "labels" : {
        "submit" : "Submit",
        "reject" : "Back"
      },
      "enableAutoApprove" : false,
      "failoverState" : 2,
      "successState" : 1,
      "dynamicAuth" : null,
      "regexList" : null,
      "regexOperation" : null,
      "regexPattern" : null,
      "accessMode" : null
    },
    "data" : null,
    "api_list" : null
  }, {
    "uniqueId" : null,
    "directoryUniqueId" : null,
    "source" : null,
    "tags" : [ ],
    "userName" : null,
    "objectType" : "TaskDetails",
    "description" : "",
    "historyReferences" : [ ],
    "usedHistory" : null,
    "sampleInput" : null,
    "sampleOutput" : null,
    "contentTab" : null,
    "successiveTasks" : {
      "incoming" : [ {
        "taskId" : "createform_1",
        "taskName" : null,
        "subflowId" : "Ym3Jra2C",
        "parentSubflowId" : "DVWpo1UZ",
        "taskType" : "start",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ],
      "success" : [ {
        "taskId" : "workflow_stop_1",
        "taskName" : null,
        "subflowId" : "Ym3Jra2C",
        "parentSubflowId" : "DVWpo1UZ",
        "taskType" : "stop",
        "flowName" : null,
        "linkType" : null,
        "backwardLink" : false
      } ]
    },
    "flowPathID" : null,
    "ignoredForStatusComputation" : false,
    "flowName" : "Certificate revokation",
    "subFlowID" : "smwBixBv",
    "globalData" : null,
    "input" : [ {
      "name" : null,
      "key" : "reason_appviewx",
      "value" : "<%reason_appviewx%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "reason_appviewx",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "reason_microsoft",
      "value" : "<%reason_microsoft%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "reason_microsoft",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "ca_account",
      "value" : "<%ca_account%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "ca_account",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "sessionId",
      "value" : "<%sessionId%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "sessionId",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "revokation_mode",
      "value" : "<%revokation_mode%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "revokation_mode",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "cert_name",
      "value" : "<%cert_name%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_name",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "reason",
      "value" : "<%reason%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "reason",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "cert_name_basedon_ca",
      "value" : "<%cert_name_basedon_ca%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_name_basedon_ca",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : null,
      "key" : "cert_authority",
      "value" : "<%cert_authority%>",
      "description" : null,
      "dataType" : "Json",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : null,
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_authority",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    } ],
    "notificationMessage" : {
      "0" : "",
      "1" : "",
      "2" : ""
    },
    "ancestor" : null,
    "metaData" : {
      "taskHeader" : "Script",
      "hide" : false,
      "lock" : false,
      "successState" : 1,
      "failoverState" : 2,
      "taskScope" : null,
      "hideFromStageView" : false,
      "mode" : "Developer",
      "nature" : "normal",
      "lowCodeTask" : false
    },
    "parentSubFlowID" : "DVWpo1UZ",
    "helpContent" : null,
    "name" : "",
    "syncExecution" : true,
    "_id" : null,
    "task_id" : "script_1",
    "task_name" : "Certificate Revokation script",
    "task_type" : "script",
    "task_category" : "script",
    "component_type" : "others",
    "setNullProperties" : true,
    "folderName" : "Cert+ OOB",
    "sub_group" : "script",
    "group_name" : "General",
    "viewable_type" : "custom",
    "scriptType" : "Python",
    "scriptContent" : "import sys\nimport requests\nimport json\n\nsys.path.append(AVX::DEPENDENCIES)\nsys.path.append(AVX::HELPER)\n\nimport appviewx\nimport logger_util\nimport time\n\nrevokation_mode = '<%revokation_mode%>'\nnull = None\ntrue = True\nfalse = False\n\ndef fetch_gateway_key():\n    '''\n    fetch the gateway key from appviewx config file\n    :return: appviewx gateway key\n    '''\n    conf_content = {}\n    abs_path = os.path.dirname(os.path.abspath(__file__))\n\n    prop_file_path = abs_path + \"/../properties/appviewx.properties\"\n    prop_file = open(prop_file_path)\n    prop_file_lines = prop_file.readlines()\n    for line in prop_file_lines:\n        if line is not \"\\n\" and \"GATEWAY_KEY\" in line or \"GATEWAY_BASE_URL\" in line:\n            conf_content[line.split(\"=\")[0]] = line.split(\"=\")[1].replace(\"\\n\", \"\")\n    return conf_content['GATEWAY_BASE_URL'], conf_content['GATEWAY_KEY']\n    prop_file.close()\n    \ndef get_uuid_from_commonname_slno(common_name, serial_number):\n    \"\"\"\n    Function to fetch uuid from common name and serial number\n    :param session_id: session ID\n    :param common_name (str) : certificate common name \n    :param serial_number (str) : certificate serial number\n    :return (str): uuid of a certificate\n    \"\"\"\n    key = str()\n    gateway_url, gateway_key = fetch_gateway_key()\n    cwd = os.getcwd()\n    url = \"{}avxapi/cert-fetch-uuid-by-cn-serial-number?gwkey={}&gwsource=external\".format(gateway_url, gateway_key)\n    headers = {\"sessionId\": \"<%sessionId%>\" , \"Content-Type\": \"application/json\", \"Accept\": \"application/json\"}\n\n    payload = {\n                \"payload\":  {\n                            \"commonName\": common_name,\n                            \"serialNumber\": serial_number\n                            }\n            }\n\n    response = requests.post(url=url, headers=headers, data=json.dumps(payload), verify=False)\n    if response.status_code != 200:\n        raise Exception(str(response.reason))\n    response = response.json()\n    return response.get(\"response\")\n    \n\ndef revoke_certificate_using_uuid(uuid,reason):\n    \"\"\"\n    Function to revoke certificate with certificate uuid\n    :param session_id: session ID \n    :param uuid (str): uuid of the certificate\n    :return (str): uuid of a certificate\n    \"\"\"\n    gateway_url, gateway_key = fetch_gateway_key()\n    cwd = os.getcwd()\n    url = \"{}avxapi/cert-revoke-hv?gwkey={}&gwsource=external\".format(gateway_url, gateway_key)\n    headers = {\"sessionId\": \"<%sessionId%>\" , \"Content-Type\": \"application/json\", \"Accept\": \"application/json\"}\n\n    payload = { \"payload\" : {\"certificateUuid\":uuid,\"reason\":reason,\"comments\":\"\"} }\n    \n    ca_settings = get_certificate(uuid)\n    \n    if \"<%ca_account%>\" == ca_settings:\n        response = requests.post(url=url, headers=headers, data=json.dumps(payload), verify=False)\n        if response.status_code != 200:\n            raise Exception(str(response.reason))\n        response = response.json()\n        AVX::LOG(\"-------Certificate revokation triggered successfully-------\")\n        return response.get(\"response\")\n\n\ndef get_certificate(uuid):\n    \"\"\"\n    Function to revoke certificate with certificate uuid\n    :param uuid (str): uuid\n    :return (dict): certificate content\n    \"\"\"\n    key = str()\n    gateway_url, gateway_key = fetch_gateway_key()\n    cwd = os.getcwd()\n    url = \"{}avxapi/cert-get-by-uuid?gwkey={}&gwsource=external\".format(gateway_url, gateway_key)\n    headers = {\"sessionId\": \"<%sessionId%>\" , \"Content-Type\": \"application/json\", \"Accept\": \"application/json\"}\n    payload = { \"payload\" : [uuid] }\n    response = requests.post(url=url, headers=headers, data=json.dumps(payload), verify=False)\n    if response.status_code != 200:\n        AVX::LOG(\"Revokation failed due to : \"+str(response.reason))\n        return ''\n    response = response.json()\n\n    cert_content =  response.get(\"response\").values()\n    \n    for cert_ca in cert_content:\n        return cert_ca.get(\"issuer\").get(\"issuerSettingsName\")\n    return ''\n\n\nif __name__ == \"__main__\":\n\n    cert_names_slno_list = str(\"<%cert_name_basedon_ca%>\").split(\",\")\n    certs_cn_slno = str(\"<%cert_name%>\").split(\",\")\n    uuid_list = []\n    certificate_authority = \"<%cert_authority%>\"\n    \n    if \"<%reason%>\":\n        reason = \"<%reason%>\"\n    if certificate_authority == \"Microsoft Enterprise\":\n        reason = \"<%reason_microsoft%>\"\n    if certificate_authority == \"AppViewX\":\n        reason = \"<%reason_appviewx%>\"\n    \n    if revokation_mode == \"Common name\" :\n        for cn_sl in certs_cn_slno:\n            common_name = cn_sl.split(\"|\")[0]\n            serial_number = cn_sl.split(\"|\")[1]\n            uuid_list.append(get_uuid_from_commonname_slno(common_name, serial_number))\n            AVX::LOG(str(uuid_list))\n        \n        for uuid in uuid_list:\n            if uuid:\n                revoke_certificate_using_uuid(uuid,reason)\n    else:\n        for cn_sl in cert_names_slno_list:\n            common_name = cn_sl.split('|')[0]\n            serial_number = cn = cn_sl.split('|')[1]\n            uuid_list.append(get_uuid_from_commonname_slno(common_name, serial_number))\n        for uuid in uuid_list:\n            if uuid:\n                revoke_certificate_using_uuid(uuid,reason)\n                time.sleep(2)\n                \n    AVX::OUTPUT({})",
    "http_method" : "POST",
    "action_id" : "run-script"
  } ],
  "subFlowID" : "smwBixBv",
  "taskGlobalData" : {
    "workflow_stop_1" : [ ],
    "createform_1" : [ {
      "name" : "Reason",
      "key" : "reason_appviewx",
      "value" : "reason_appviewx",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "Key compromised,CA compromised,Privilege withdrawn,Unspecified",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "reason_appviewx",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Reason",
      "key" : "reason_microsoft",
      "value" : "reason_microsoft",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "Key compromise,CA compromise,Affiliation changed,Superseded,Cessation of operation",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "reason_microsoft",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "CA Account",
      "key" : "ca_account",
      "value" : "ca_account",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "ca_account",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Common name",
      "key" : "common_name",
      "value" : "common_name",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "common_name",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Select revokation mode",
      "key" : "revokation_mode",
      "value" : "revokation_mode",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "Certificate authority",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "revokation_mode",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Certificate name",
      "key" : "cert_name",
      "value" : "cert_name",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_name",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Reason",
      "key" : "reason",
      "value" : "reason",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "reason",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Certificate name",
      "key" : "cert_name_basedon_ca",
      "value" : "cert_name_basedon_ca",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_name_basedon_ca",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Certificate group",
      "key" : "cert_group",
      "value" : "cert_group",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_group",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    }, {
      "name" : "Certificate authority",
      "key" : "cert_authority",
      "value" : "cert_authority",
      "description" : null,
      "dataType" : "string",
      "size" : 0,
      "variableType" : "global",
      "defaultValues" : "",
      "mandatory" : false,
      "showToolTip" : false,
      "useDefaultValue" : false,
      "variableDeclared" : false,
      "variableUsed" : false,
      "sourceTasks" : null,
      "destinationTasks" : null,
      "enableForIOVariables" : true,
      "order" : 0,
      "label" : "cert_authority",
      "dataValidation" : null,
      "notification" : null,
      "elementType" : null,
      "type" : "Custom",
      "_id" : null
    } ],
    "script_1" : [ ]
  },
  "type" : null,
  "level" : 1,
  "maxDepth" : 0,
  "input" : null,
  "workflowName" : "Certificate Revoke OOB",
  "description" : "",
  "flowName" : "Certificate revokation",
  "workflowType" : "Default",
  "subFlowType" : "Flow",
  "parentSubFlowID" : "DVWpo1UZ",
  "logs" : [ {
    "user" : null,
    "time" : 1596478781650,
    "message" : "Flow created successfully with : Certificate revokation for the workflow : Certificate Revoke OOB"
  } ],
  "workflowVersion" : "master"
} ]